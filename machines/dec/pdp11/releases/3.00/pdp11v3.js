(function(){/*
 https://www.pcjs.org/modules/dl11.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/pc11.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/defs.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/numio.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/stdio.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/webio.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/device.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/input.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/led.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/time.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/bus.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/memory.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/ports.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/ram.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/rom.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/cpu.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/debugger.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/pdp11ops.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/pdp11.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/pdp11dbg.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/iopage.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/machine.js (C) 2012-2021 Jeff Parsons
*/
var l;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){if(!(a instanceof Array)){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];a=b?b.call(a):{next:aa(a)};for(var c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}var ca="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},da;
if("function"==typeof Object.setPrototypeOf)da=Object.setPrototypeOf;else{var ea;a:{var fa={Gb:!0},ha={};try{ha.__proto__=fa;ea=ha.Gb;break a}catch(a){}ea=!1}da=ea?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ia=da;
function m(a,b){a.prototype=ca(b.prototype);a.prototype.constructor=a;if(ia)ia(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c]}var ja="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
function ka(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}return globalThis}var la=ka(this);function ma(a,b){if(b){var c=la;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ja(c,a,{configurable:!0,writable:!0,value:b})}}
ma("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var c=Math.floor(Math.abs(b));return 0>b?-c:c}});ma("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});
ma("String.prototype.repeat",function(a){return a?a:function(b){if(null==this)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var c=this;if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});function na(){na=function(){};la.Symbol||(la.Symbol=oa)}function pa(a,b){this.o=a;ja(this,"description",{configurable:!0,writable:!0,value:b})}pa.prototype.toString=function(){return this.o};
var oa=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new pa("jscomp_symbol_"+(c||"")+"_"+b++,c)}var b=0;return a}();function qa(){na();var a=la.Symbol.iterator;a||(a=la.Symbol.iterator=la.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&ja(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return ra(aa(this))}});qa=function(){}}
function ra(a){qa();a={next:a};a[la.Symbol.iterator]=function(){return this};return a}function sa(a,b){qa();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d}ma("Array.prototype.keys",function(a){return a?a:function(){return sa(this,function(b){return b})}});
ma("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;0>c&&(c=Math.max(0,e+c));if(null==d||d>e)d=e;d=Number(d);0>d&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});ma("Number.parseInt",function(a){return a||parseInt});ma("Array.prototype.values",function(a){return a?a:function(){return sa(this,function(b,c){return c})}});function ta(){}var ua,va=new ArrayBuffer(2);(new DataView(va)).setUint16(0,256,!0);ua=256===(new Uint16Array(va))[0];
var v={Xb:0xffffffffffff,NONE:0,ld:0,Ra:0x800000000000},wa={Ud:{Ta:4,pa:16},jc:{Ta:5,pa:32},pd:{Ta:6,pa:64},ec:{Ta:8,pa:256},qd:{Ta:20,pa:1048576},Lg:{Ta:22,pa:4194304}},x={};x.Defs=ta;function xa(){}m(xa,ta);
function ya(a,b){if(a){b||(b=10);var c,d=0<a.indexOf(",");d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);"#"==c?(b=8,c=""):"$"==c&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),"0b"==c&&d||"^B"==c?(b=2,c=""):"0o"==c||"^O"==c?(b=8,c=""):"^D"==c?(b=10,c=""):"0x"==c&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);"Y"==c||"y"==c?(b=2,c=""):"."==c?(b=10,c=""):"H"==c||"h"==c?(b=16,c=""):"K"==c?c="000":"M"==c?c="000000":"G"==c&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;10>=b&&(c=a.match(/(-?[0-9]+)B([0-9]*)$/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&10!=b?16==b?null!==a.match(/^-?[0-9a-f]+$/i):8==b?null!==a.match(/^-?[0-7]+$/):2==b&&null!==a.match(/^-?[01]+$/):null!==a.match(/^[+-]?[0-9]+$/))&&!isNaN(f=parseInt(a,b))){e&&(0>f&&(f+=Math.pow(2,36)),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function z(a,b,c,d,e){d=void 0===d?0:d;var f=void 0===f?0:f;var g="",k="",h=-1;c||(c=a.aa||10);d&&(h=Math.ceil(d/Math.log2(c)));if(void 0==e)switch(c){case 8:e="0o";break;case 16:e="0x";break;case 10:k=".";default:e=""}isNaN(b)||"number"!=typeof b?(b=void 0,e=k=""):(0>b&&-1<b&&(b=-1),d&&(0>b&&(b+=Math.pow(2,d)),b>=Math.pow(2,d)&&(h=Math.ceil(Math.log(b)/Math.log(c)))));for(a=f||-1;h--;){a||(g=","+g,a=f);if(void 0==b){if(g="?"+g,0>h)break}else if(d=b%c,b=Math.trunc(b/c),d+=0<=d&&9>=d?48:55,g=String.fromCharCode(d)+
g,!b&&0>h)break;a--}return e+g+k}function za(a,b){var c=a/D|0,d=b/D|0;return(a&b)==(b|0)&&(c&d)==d}function Aa(a){for(var b=0,c=0,d=[];b<a.length;){for(var e=a[b],f=b+1;f<a.length&&a[f]===e;)f++;d[c++]=f-b;d[c++]=e;b=f}return d.length>=a.length?a:d}var D=Math.pow(2,32);x.NumIO=xa;function Ba(){this.Qa={};for(var a=0;22>a;a++)this.Qa["ACDFHGMNSTWYbdfjcsoXx%"[a]]=null}m(Ba,xa);function Ca(a,b,c){a.Qa[b]||(a.Qa[b]=c)}l=Ba.prototype;l.flush=function(){var a=Da;Da="";this.Ha(a)};
function Ea(a,b){var c=a,d=a.lastIndexOf("/");0<=d&&(c=a.substr(d+1));d=c.indexOf("&");0<d&&(c=c.substr(0,d));b&&(d=c.lastIndexOf("."),0<d&&(c=c.substring(0,d)));return c}
l.Fe=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];void 0===b[0]?b=new Date(Date.now()):"string"===typeof b[0]?(c=b[0],0>c.indexOf(":")?c+=" "+(b[1]||"00:00:00 UTC"):c.match(/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/)&&(b[1]||(c+=" UTC")),b=new Date(c)):b=void 0===b[1]?new Date(b[0]):new Date(Date.UTC.apply(Date,ba(b)));return b};
l.Ha=function(a,b){var c=a.lastIndexOf("\n");b?0<=c&&(b=Date.now(),Fa||(Fa=b),a=((b-Fa)/1E3).toFixed(3)+": "+a):(0<=c&&(console.log(Da+a.substr(0,c)),Da="",a=a.substr(c+1)),Fa=null);Da+=a;return a.length};function G(a,b,c){a.Ha(b+"\n",c)}l.l=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];return this.Ha(this.w.apply(this,[a].concat(ba(c))))};
l.w=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(!c||!c.length)return a;d="";var e=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([bwhlL]?)([A-Za-z%])/),f=0,g;for(g=0;g<e.length-6;g+=6){d+=e[g];var k=e[g+5];if(void 0===this.Qa[k])d+="%"+e[g+1]+e[g+2]+e[g+3]+e[g+4]+k;else{if(f<c.length){var h=c[f];"%"!=k&&f++}else h=c[c.length-1];var p=e[g+1],n=0<=p.indexOf("#"),t=0<=p.indexOf("0"),q=e[g+2];"*"==q?(q=h,h=f<c.length?c[f++]:c[c.length-1]):q=+q||0;var r=e[g+3];r=r?+r.substr(1):
-1;var w=e[g+4],u=null,A=0,B="";var y=0<="ACDFHGMNSTWY".indexOf(k)&&"object"!=typeof h?this.Fe(h):h;switch(k){case "C":h=n?"#":"";d+=isNaN(y.getTime())?void 0:this.w(this.w("%%%sW, %%%sF %%%sD, %%%sY",h),y);continue;case "D":h=n?y.getUTCDate():y.getDate();k="d";break;case "A":case "G":case "H":h=n?y.getUTCHours():y.getHours();"A"==k?(h=12>h?"am":"pm",k="s"):("G"==k&&(h=h?12<h?h-12:h:12),k="d");break;case "F":case "M":h=n?y.getUTCMonth():y.getMonth();"F"==k?(h=Ga[h],k="s"):(h++,k="d");break;case "N":h=
n?y.getUTCMinutes():y.getMinutes();k="d";break;case "S":h=n?y.getUTCSeconds():y.getSeconds();k="d";break;case "T":h=n?"#":"";d+=isNaN(y.getTime())?void 0:this.w(this.w("%%%sY-%%%s02M-%%%s02D %%%s02H:%%%s02N:%%%s02S",h),y);continue;case "W":h=Ha[n?y.getUTCDay():y.getDay()];k="s";break;case "Y":h=n?y.getUTCFullYear():y.getFullYear(),0<r&&(h%=Math.pow(10,r),r=-1),k="d"}switch(k){case "b":d+=h?"true":"false";break;case "d":h=Math.trunc(h),0<=r&&(t=!0,q<r&&(q=r),r=-1);case "f":h=+h;y=h+"";0<=r&&(y=h.toFixed(r));
y.length<q&&(t?(0>h&&(q--,y=y.substr(1)),y=("0".repeat(q)+y).slice(-q),0>h&&(y="-"+y)):y=(" ".repeat(q)+y).slice(-q));d+=y;break;case "j":d+=JSON.stringify(h,null,q||void 0);break;case "c":h="string"==typeof h?h[0]:String.fromCharCode(h);case "s":if(void 0!=h)for("string"!=typeof h&&(h=h.toString()),0<=r&&(h=h.substr(0,r));h.length<q;)h=0<=p.indexOf("-")?h+" ":" "+h;d+=h;break;case "o":A=8,n&&(B="0");case "X":u=Ia;case "x":y="";A||(A=16);!B&&n&&(B="0x");u||(u=Ja);h=Math.trunc(h);0<=r&&(t=!0,q<r&&
(q=r));t&&!q&&("b"==w?q=2:"h"==w||"w"==w?q=4:"l"==w?q=8:(q=Math.abs(h),q=255>=q?2:65535>=q?4:4294967295>=q?8:9),q+=B.length);q-=B.length;do n=h&A-1,h>>>=16==A?4:3,t||!y||n||h?y=u[n]+y:(B&&(y=B+y,B=""),0<q&&(y=" "+y));while(0<--q||h);d+=B+y;break;case "%":d+="%";break;default:this.Qa[k]?d+=this.Qa[k](k,p,q,r,h):d+="(unimplemented sprintf type: %"+k+")"}}}return d+=e[g]};
var Da="",Fa=null,Ja="0123456789abcdef",Ia="0123456789ABCDEF",Ha="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ga="January February March April May June July August September October November December".split(" ");x.StdIO=Ba;function Ka(a){Ba.call(this);this.Y={};this.ja=0;this.S=this;a&&(this.S.ja=0,this.S.Ea=[],this.S.Aa=0,this.S.eb={},this.S.Xg=!1)}var La;m(Ka,Ba);l=Ka.prototype;
l.Ia=function(a,b){var c=this,d=this;switch(a){case Ma.gd:b.onclick=function(){var e=c.Pa(Ma.fb,!0);e&&(e.value="")};break;case Ma.fb:Na(b),b.addEventListener("keydown",function(e){Oa(d,e,!0)}),b.addEventListener("keypress",function(e){Oa(d,e)})}};function Pa(a,b){var c=Qa.gc;a.S.eb[c]||(a.S.eb[c]=[]);a.S.eb[c].push(b)}function Ra(a,b,c){var d=!1;"boolean"==typeof b&&(d=b,b=c.shift());if(b=a.w.apply(a,[b].concat(ba(c))))G(a,b),d||alert(b)}
function Na(a){a.setAttribute("autocapitalize","off");a.setAttribute("autocomplete","off");a.setAttribute("autocorrect","off");a.setAttribute("spellcheck","false");a.value=""}l.error=function(a,b){Ra(this,"%s",this.w.apply(this,[a].concat(ba(b))))};l.Pa=function(a){return this.Y[a]};
function Sa(a){var b=window;if(b){do{for(var c=0;c<Ta.length;c++){var d=Ta[c];d=d?d+a[0].toUpperCase():a[0];d+=a.substr(1);if(d in b)return d}if(0>a.indexOf("screen"))break;a=a.replace("screen","Screen")}while(1)}return null}function Ua(a,b){return a.s.bindings&&a.s.bindings[b]}function Va(a){if(a=a.Y[Wa])var b=a.textContent;return b}function Xa(a,b,c){a=+a||0;a<b&&(a=b);a>c&&(a=c);return a}
function H(a,b,c,d){a=a.s[b];void 0===a?a=c:(d&&void 0!==d[a]&&(a=d[a]),d=typeof c,typeof a!=d&&("boolean"==d?a=!!a:"number"==typeof c&&(a=+a)));return a}function Ya(a,b,c){if("string"==typeof b)return Za(b,function(d,e,f,g){var k=!1;if(g){k=0>g;var h=d}else{if(4!=f)return;try{var p=JSON.parse(e)}catch(n){h=n.message||"unknown error"}}h&&Ra(a,k,"Unable to load %s media (error %d: %s)");c(p)}),!1;c(b);return!0}
function Za(a,b){var c=0,d=null,e=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");e.onreadystatechange=function(){4===e.readyState&&(d=e.responseText,200==e.status||!e.status&&d.length&&"file:"==(window?window.location.protocol:"file:")||(c=e.status||-1));b(a,d,e.readyState,c)};e.open("GET",a,!0);e.send()}
function $a(a){if(void 0===ab.tb){var b=!1;if(window)try{window.localStorage.setItem(ab.Xa,ab.Xa),b=window.localStorage.getItem(ab.Xa)==ab.Xa,window.localStorage.removeItem(ab.Xa)}catch(c){G(a,c.message),b=!1}ab.tb=b}return!!ab.tb}function bb(a,b){b=void 0===b?0:b;1<b&&b%2&&b--;b=b||a.ja;return-1==(b|1)||za(a.S.ja,b)?!0:!1}
function cb(a){if(window){var b=window.navigator.userAgent;return"iOS"==a&&(!!b.match(/(iPod|iPhone|iPad)/)||"MacIntel"===window.navigator.platform&&1<window.navigator.maxTouchPoints)||"MSIE"==a&&!!b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)}return!1}function db(a){var b=null;if($a(a)){var c;if(window)try{(c=window.localStorage.getItem(a.T))&&(b=JSON.parse(c))}catch(d){G(a,d.message)}}return b}
function Oa(a,b,c){b=b||window.event;var d=b.which||b.keyCode;if(d){var e=a.S,f=b.target;if(c){a=!1;var g;c=f.value;var k=c.lastIndexOf("\n");d==I.Zb&&f.selectionStart<=k+1&&(a=!0);d==I.ge?(a=!0,0<e.Aa&&(g=e.Ea[--e.Aa])):d==I.od&&(a=!0,e.Aa<e.Ea.length&&(g=e.Ea[++e.Aa]||""));a&&b.preventDefault();void 0!=g&&(f.value=c.substr(0,k+1)+g)}else d=String.fromCharCode(d),g=f.value,c=g.lastIndexOf("\n"),f.selectionStart<=c&&f.setSelectionRange(g.length,g.length),b.stopPropagation(),"@"==d&&0<e.Aa&&c+1==g.length&&
(f.value+=e.Ea[--e.Aa],d="\r"),"\r"==d&&(b.preventDefault(),g=f.value+="\n",f.blur(),f.focus(),(b=eb(a,g.slice(g.lastIndexOf("\n",g.length-2)+1,-1)||""))&&G(a,b.replace(/\n$/,""),!1))}}function fb(a){return"true"==a||"on"==a?!0:"false"==a||"off"==a?!1:void 0}
function gb(a,b){if(void 0!=b){var c=a.S;try{if(b=b.trim())c.Aa<c.Ea.length&&b==c.Ea[c.Aa]?c.Aa++:(c.Ea.push(b),c.Aa=c.Ea.length);var d=b.split(" "),e=d[0],f=a.S.eb[Qa.gc];switch(e[0]){case "m":if("?"==e[1]){var g="";hb.forEach(function(t){g+=t+"\n"});g&&(g="message commands:\n"+g);break}g="";var k=void 0;e=d[d.length-1].toLowerCase();var h=fb(e);void 0!=h&&d.pop();1>=d.length&&(void 0!=h&&(k=h,h=void 0),d[1]="all");"all"==d[1]&&(d=Object.keys(J));for(f=1;f<d.length;f++){e=d[f];var p=J[e];if(!p){g+=
"unrecognized message: "+e+"\n";break}void 0!=h&&ib(a,p,h);if(void 0==k||k==bb(a,p))g+=a.w("%8s: %b\n",e,bb(a,p))}bb(a,v.Ra)&&(g+="all messages will be buffered until buffer is turned off\n");g||(g="no messages\n");break;case "?":g="",jb.forEach(function(t){g+=t+"\n"}),g&&(g="default commands:\n"+g);default:if(d.unshift(b),f)for(a=0;a<f.length;a++){var n=f[a](d);if(void 0!=n){g=g?g+n:n;break}}}}catch(t){g="error: "+t.message+"\n"}}return g}
function eb(a,b){b=void 0===b?"?":b;if(b){var c="";b=b.split(/(?:\n|;\s*)/);for(var d=0;d<b.length;d++)c+=gb(a,b[d])}return c}l.Ha=function(a,b){void 0==b&&(b=bb(this,v.Ra));if(!b){var c=this.Pa(Ma.fb,!0);if(c)return c.value.substr(-a.length)!=a&&(c.value+=a,8192<c.value.length&&(c.value=c.value.substr(c.value.length-4096)),c.scrollTop=c.scrollHeight,cb("iOS")||c.setSelectionRange(c.value.length,c.value.length)),a.length}return Ba.prototype.Ha.call(this,a,b)};
l.l=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];d=0;"number"==typeof a&&(d=a,a=c.shift());return bb(this,d)?Ba.prototype.l.call.apply(Ba.prototype.l,[this,a].concat(ba(c))):0};function kb(a,b){if($a(a)){b=JSON.stringify(b);try{window.localStorage.setItem(a.T,b)}catch(c){G(a,c.message)}}}function lb(a,b,c){(a=a.Y[b])&&a.textContent!=c&&(a.textContent=c)}
function ib(a,b,c){var d=!1;c?(c=a.S.ja,a.S.ja=(c|b)+(c/D|0|b/D|0)*D):(d=za(a.S.ja,v.Ra)&&za(b,v.Ra),c=a.S.ja,a.S.ja=(c&~b)+((c/D|0)&~(b/D|0))*D);d&&a.flush()}
var Ma={gd:"clear",fb:"print"},jb=["\u2191 \u2193\t\trecall commands","@\t\trepeat last command","m?\t\tmessage commands"],hb=["m\t\tdisplay all messages","m on\t\tdisplay all active messages","m off\t\tdisplay all inactive messages","m all [on|off]\tturn all messages on or off","m ... [on|off]\tturn selected messages on or off"],J={all:v.Xb,buffer:v.Ra},Qa={gc:"command"},mb={ic:13,sb:65,Yb:66,dc:67,kc:68,E:69,mc:70,oc:71,pc:72,qc:73,rc:74,sc:75,uc:76,xc:77,yc:78,zc:79,Ac:80,Q:81,Bc:82,Dc:83,Ec:84,
Gc:85,Hc:86,Jc:87,Kc:88,Mc:89,Fb:90,Gb:97,Og:98,Pg:99,d:100,e:101,Tg:102,Ug:103,Wg:104,Yg:105,Zg:106,k:107,$g:108,ah:109,n:110,bh:111,p:112,q:113,r:114,dh:115,t:116,fh:117,gh:118,hh:119,x:120,y:121,z:122},I={Zb:8,be:9,Ed:10,ic:13,Zd:16,jd:17,cd:18,Cg:19,ub:20,Ef:27,ae:32,Fg:33,Eg:34,Df:35,Zf:36,wc:37,ge:38,zb:39,Wf:39,od:40,Tf:44,Gg:44,$f:45,Cf:46,Vf:46,Yf:47,ZERO:48,ONE:49,fe:50,ce:51,Ad:52,zd:53,$d:54,Yd:55,rd:56,Ld:57,xd:59,wd:61,sb:65,Yb:66,dc:67,kc:68,E:69,mc:70,oc:71,pc:72,qc:73,rc:74,sc:75,
uc:76,xc:77,yc:78,zc:79,Ac:80,Q:81,Bc:82,Dc:83,Ec:84,Gc:85,Hc:86,Jc:87,Kc:88,Mc:89,Fb:90,fc:91,Uf:91,Sf:92,Jg:93,Xf:93,dg:96,ug:96,Rf:96,eg:97,sg:97,fg:98,rg:98,gg:99,xg:99,hg:100,vg:100,ig:101,og:101,jg:102,zg:102,kg:103,tg:103,lg:104,Bg:104,mg:105,yg:105,wg:106,ng:107,Ag:109,pg:110,qg:111,Ff:112,Jf:113,Kf:114,Lf:115,Mf:116,Nf:117,Of:118,Pf:119,Qf:120,Gf:121,Hf:122,If:123,Md:144,Wd:145,vd:173,Xd:186,sd:187,Af:188,kd:189,Dg:190,Mg:191,yf:192,ag:219,zf:220,Ig:221,Hg:222,ud:224,bg:901,Ic:1E3},nb={},
ob=(nb[I.xd]=I.Xd,nb[I.wd]=I.sd,nb[I.vd]=I.kd,nb[I.ud]=I.fc,nb),pb={wc:1,zb:2,cg:3},K={},qb=(K[I.Zb]="\b",K[I.be]="\t",K[I.Ed]="\n",K[I.ic]="\r",K[I.ae]=" ",K[I.ZERO]="0",K[I.ONE]="1",K[I.fe]="2",K[I.ce]="3",K[I.Ad]="4",K[I.zd]="5",K[I.$d]="6",K[I.Yd]="7",K[I.rd]="8",K[I.Ld]="9",K[I.sb]="A",K[I.Yb]="B",K[I.dc]="C",K[I.kc]="D",K[I.E]="E",K[I.mc]="F",K[I.oc]="G",K[I.pc]="H",K[I.qc]="I",K[I.rc]="J",K[I.sc]="K",K[I.uc]="L",K[I.xc]="M",K[I.yc]="N",K[I.zc]="O",K[I.Ac]="P",K[I.Q]="Q",K[I.Bc]="R",K[I.Dc]=
"S",K[I.Ec]="T",K[I.Gc]="U",K[I.Hc]="V",K[I.Jc]="W",K[I.Kc]="X",K[I.Mc]="Y",K[I.Fb]="Z",K[I.wc]="Left",K[I.zb]="Right",K),Ta=["","moz","ms","webkit"],rb={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",
crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",
forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",
lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",
seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},ab={tb:void 0,Xa:"PCjs.localStorage"};x.WebIO=Ka;
function L(a,b,c,d){a=void 0===a?"default":a;b=void 0===b?a:b;c=void 0===c?{}:c;d=void 0===d?[]:d;Ka.call(this,a==b);this.T=a;this.M=b;sb[this.T]||(sb[this.T]={});sb[this.T][this.M]&&this.l("warning: machine configuration contains multiple '%s' devices\n",this.M);sb[this.T][this.M]=this;this.id=this.T==this.M?this.T:this.T+"."+this.M;tb.push(this);this.S=ub(this,this.T);this.ready=!0;vb(this,c,d);this.Fa={};this.Lc=[]}m(L,Ka);l=L.prototype;l.Hb=function(){};l.Ib=function(){};
function vb(a,b,c){c=b.overrides||c;if(c.length){var d,e=La;if(!e){e={};if(window){d||(d=window.location.search.substr(1));for(var f,g=/\+/g,k=/([^&=]+)=?([^&]*)/g;f=k.exec(d);)e[decodeURIComponent(f[1].replace(g," ")).trim()]=decodeURIComponent(f[2].replace(g," ")).trim()}La=e}d=e;for(var h in d)0<=c.indexOf(h)&&(e=d[h],f=ya(e,10),void 0==f&&("true"==e?f=!0:"false"==e?f=!1:(f=e,e='"'+e+'"')),b[h]=f,G(a,"overriding "+a.M+" property '"+h+"' with "+e))}a.s=b;c=b.bindings;c=void 0===c?{}:c;if("undefined"!=
typeof document){a.s.Y||(a.s.Y=c);(h=Array.isArray(c))?0>c.indexOf("container")&&c.push("container"):c.container||(c.container=a.M);for(var p in c){e=c[p];if(h)p=e;else if(e.match(/^[0-9]+$/)){d=+e;a.Y[p]=[];do{e=p+d++;e=document.getElementById(e);if(!e)break;a.Y[p].push(e)}while(1);continue}if(d=document.getElementById(e))a.Y[p]=d,a.Ia(p,d)}}b=void 0===b?{}:b;a.version=3;if(a.version){p="";var n;a.T!=a.M&&(n=ub(a,a.T).version)&&n!=a.version&&(p="Machine");p||(n=b.version)&&n>a.version&&(p="Config");
p&&(n=a.w("%s Device version (%3.2f) incompatible with %s version (%3.2f)",b.Qg,a.version,p,n),a.error("%s\n\nClearing your browser's cache may resolve the issue.",n))}}function M(a,b,c,d){a.Fa[b]={get:c.bind(a),set:d?d.bind(a):null}}function wb(a,b,c){a.Fa[b]&&(a.Fa[c]=a.Fa[b])}function xb(a,b){var c;try{var d=sb[a.T];if(d)for(c in d){var e=d[c];if(e.M!=e.T&&!b(e))return!1}return!0}catch(f){a.l("error while enumerating device '%s': %s\n",c,f.message)}return!1}
l.Pa=function(a,b){b=void 0===b?!1:b;if(a){var c=Ka.prototype.Pa.call(this,a,b);if(void 0===c&&b){b=sb[this.T];for(var d in b)if(c=b[d].Y[a])break;c||(c=null);this.Y[a]=c}}return c};function ub(a,b,c){var d=b,e=a.T,f=e.indexOf(".");0<f&&(e=e.substr(0,f),b=b.substr(f+1));b=(f=sb[e])&&f[b]||null;if(!b){for(f=0;f<tb.length;f++)if(tb[f].id===d){b=tb[f];break}if(!b&&(void 0===c||c))throw Error(a.w('no "%s" device',d));}return b}
function O(a,b,c){var d=null,e=sb[a.T];if(e)for(var f in e)if(e[f].s["class"]==b){if(d){d=null;break}d=e[f]}if(!d&&(void 0===c||c))throw Error(a.w("no %s device",b));return d}function yb(a,b){var c=ub(a,a.T);return c&&c.s&&c.s[b]||a.s[b]}function zb(a,b){return(a=a.Fa[b])&&a.get()}function Ab(a){return a==a.S&&a.ready?xb(a,function(b){return Ab(b)}):a.ready}function Bb(a,b){b=void 0===b?a.ready:b;a.ready=b;if(Ab(a)){for(;b=a.Lc.pop();)b();a!=a.S&&Bb(a.S)}}
function Cb(a,b){if(Ab(a))return b(),!0;a.Lc.push(b);return!1}l.Yc=function(){};l.l=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];return"number"==typeof a&&bb(this,a)&&(void 0===this.W&&(this.W=O(this,"Debugger",!1)),this.W&&this.W.Yc(a),this.S.ja&v.Wb&&(void 0===this.o&&(this.o=O(this,"CPU")),this.o))?(a=c.shift(),Ka.prototype.l.call(this,"%#06x: %s.%s\n",this.o.Ob,this.M,this.w.apply(this,[a].concat(ba(c))).trim())):Ka.prototype.l.call.apply(Ka.prototype.l,[this,a].concat(ba(c)))};
function Db(a,b){(a=sb[a.T])&&delete a[b]}function Eb(a,b,c){(a=a.Fa[b])&&a.set&&a.set(c)}"undefined"!=typeof window&&(window.PCjs||(window.PCjs={}),window.PCjs.Machines||(window.PCjs.Machines={}),window.PCjs.Components||(window.PCjs.Components=[]));var sb="undefined"!=typeof window?window.PCjs.Machines:{},tb="undefined"!=typeof window?window.PCjs.Components:[];v.Wb=1;v.dd=2;v.nc=4;v.Fd=8;v.yb=16;v.fd=32;v.Dd=64;v.Wa=128;v.vb=256;v.hd=512;v.Gd=1024;v.INT=2048;v.Fc=4096;v.ie=8192;v.Hd=16384;v.Vd=32768;
v.md=65536;v.yd=131072;v.gb=262144;v.de=524288;v.lc=1048576;v.Ca=2097152;v.tc=4194304;v.Id=8388608;v.ee=16777216;v.Cd=33554432;v.hb=67108864;v.td=134217728;v.Bd=268435456;v.Bf=4294967296;J.addr=v.Wb;J.bus=v.dd;J.fault=v.nc;J.memory=v.Fd;J.ports=v.yb;J.chips=v.fd;J.kbd=v.Dd;J.serial=v.Wa;J.misc=v.vb;J.cpu=v.hd;J.mmu=v.Gd;J["int"]=v.INT;J.trap=v.Fc;J.video=v.ie;J.monitor=v.Hd;J.screen=v.Vd;J.disk=v.md;J.file=v.yd;J.time=v.gb;J.timer=v.de;J.event=v.lc;J.input=v.Ca;J.key=v.tc;J.mouse=v.Id;J.touch=v.ee;
J.info=v.Cd;J.warn=v.hb;J.error=v.td;J.halt=v.Bd;x.Device=L;
function Fb(a,b,c){L.call(this,a,b,c);this.ja=v.Ca;this.L=this.v=null;this.time=O(this,"Time");this.S=O(this,"Machine");this.V=H(this,"drag",!1);this.K=H(this,"scroll",!1);this.U=H(this,"hexagonal",!1);this.g=H(this,"releaseDelay",0,void 0);this.h=!1;a=this.s.map;this.b=this.f=null;if(a)if(a.length)this.b=a;else{this.f={};b=Object.keys(a);for(var d=0;d<b.length;d++){var e=[],f=b[d],g=a[f];"string"==typeof g?g=[g]:void 0==g.length&&(e=g.grid,g=g.keys,"string"==typeof g&&(g=[g]));this.f[f]={keys:g,
Vg:e,state:0}}}this.u=[];this.H=[];this.c=this.J=null;(a=this.Y[Gb])&&Hb(this,a,this.Pa(c.focusBinding,!0),this.s.location);this.la()}m(Fb,L);function Ib(a,b){a.v=b}function Jb(a,b,c){for(var d=0;d<a.u.length;d++){var e=a.u[d];e.id===b&&e.jb(b,c)}}
function Hb(a,b,c,d){d=void 0===d?[]:d;if(d.length||a.b||a.f){var e={};e.wf=d[0]||0;e.xf=d[1]||0;e.Za=d[2]||b.clientWidth;e.ib=d[3]||b.clientHeight;e.kb=d[4]||1;e.pb=d[5]||1;e.te=d[6]||b.naturalWidth||e.Za;e.ve=d[7]||b.naturalHeight||e.ib;e.ad=d[8]||0;e.bd=d[9]||0;e.se=d[10]||0;e.ue=d[11]||0;a.b?(e.mb=a.b.length,e.$a=a.b[0].length):(e.$a=e.kb,e.mb=e.pb,e.kb=e.pb=0);e.Uc=e.Za/(e.$a+e.$a*e.kb)|0;e.Vc=e.ib/(e.mb+e.mb*e.pb)|0;e.re=e.Uc*e.kb|0;e.Wc=e.Vc*e.pb|0;e.cb=e.rb=-1;Kb(a,b,e);Lb(a,b,e);a.time&&
a.g&&(a.R=Mb(a.time,"timerInputRelease",function(){0>e.cb&&0>e.rb&&Nb(a,-1,-1)}))}if(a.b||a.f)a.time&&a.g&&(a.X=Mb(a.time,"timerKeyRelease",function(){Ob(a)})),a.i=0,a.m="",a.j=[],d=b,c&&(d=c,a.c||"BUTTON"!=c.nodeName||(d=document,a.c=c,Pb(a,b),a.J=b)),Pb(a,d),a.c||(a.c=d)}function Qb(a){a.g?Rb(a.time,a.X,a.g):Ob(a)}
function Sb(a,b,c,d,e){if(a=a.Y[b]){for(b=0;b<a.options.length&&a.options[b].text!=c;b++);void 0==a.options.length&&(b=document.createElement("option"),b.text=c,b.value=d,(void 0===e?0:e)&&a.childNodes[0]?a.insertBefore(b,a.childNodes[0]):a.appendChild(b))}}
function Pb(a,b){function c(e,f,g){var k=document.activeElement;a.l(v.tc+v.lc,"%s.onKey%s(%d): %5.2f (%s)\n",k.id||k.nodeName,e,f,Date.now()/1E3%60,void 0!=g?g?"used":"unused":"ignored")}function d(e,f){e=document.activeElement;return a.c&&e!=a.c&&e!=a.J?null:f||window.event}b.addEventListener("keydown",function(e){if(e=d(this,e)){var f=e.which||e.keyCode,g=Tb(a,f,!0,e);c("Down",f,g);g&&e.preventDefault()}});b.addEventListener("keypress",function(e){if(e=d(this,e)){var f=e.which||e.charCode,g=Tb(a,
f);c("Press",f,g);g&&e.preventDefault()}});b.addEventListener("keyup",function(e){if(e=d(this,e)){var f=e.which||e.keyCode,g=Tb(a,f,!1,e);c("Up",f);g&&e.preventDefault();"TEXTAREA"==b.nodeName&&(b.value="")}})}
function Kb(a,b,c){b.addEventListener("mousedown",function(d){if(!a.h){var e=a.c;if(e){var f=window.scrollX,g=window.scrollY;e.focus();window.scrollTo(f,g)}d.button||Ub(a,b,Vb,d,c)}});b.addEventListener("mousemove",function(d){a.h||Ub(a,b,Wb,d,c)});b.addEventListener("mouseup",function(d){a.h||d.button||Ub(a,b,Xb,d,c)});b.addEventListener("mouseout",function(d){a.h||(0>c.cb?Ub(a,b,Wb,d,c):Ub(a,b,Xb,d,c))})}
function Lb(a,b,c){b.addEventListener("touchstart",function(d){a.K&&(a.h=!0);Ub(a,b,Vb,d,c)});b.addEventListener("touchmove",function(d){Ub(a,b,Wb,d,c)});b.addEventListener("touchend",function(d){Ub(a,b,Xb,d,c)})}
function Tb(a,b,c,d){if(void 0!=c){var e=ob[b]||b;var f=qb[b];var g=Yb[e];d=d&&d.location==pb.zb;g&Zb&&d&&(g>>=1);g&&(g&$b&&(c=!(a.a&g)),a.a=c?a.a|g:a.a&~g,Jb(a,e,c))}else f=String.fromCharCode(b).toUpperCase(),b>=mb.sb&&b<=mb.Fb?a.a&(ac|bc)||(a.a|=bc,Jb(a,I.ub,!0)):b>=mb.Gb&&b<=mb.z&&a.a&bc&&(a.a&=~bc,Jb(a,I.ub,!1));if(a.b){if(void 0!=c)return!1;for(e=0;e<a.b.length;e++)for(g=a.b[e],d=0;d<g.length;d++)if(0<=g[d].split("|").indexOf(f))return a.i?16>a.j.length&&a.j.push(b):(a.i=1,a.m=f,Nb(a,d,e),Jb(a,
f,!0),Qb(a)),!0}if(a.f){if(void 0==c)return!0;b=Object.keys(a.f);for(e=0;e<b.length;e++)if(g=b[e],0<=a.f[g].keys.indexOf(f))return Jb(a,g,c),a.f[g].state=c?1:0,!0}return!1}function Ob(a){1==a.i?(a.i++,Jb(a,a.m,!1),a.m="",Nb(a,-1,-1),Qb(a)):(a.i=0,a.j.length&&Tb(a,a.j.shift()))}Fb.prototype.la=function(){this.a=0;this.I=this.N=-1};
function Ub(a,b,c,d,e){var f=-1,g=-1,k=!1,h=-1,p=-1;if(c<Xb){d=d||window.event;d.targetTouches&&d.targetTouches.length?(h=d.targetTouches[0].clientX,p=d.targetTouches[0].clientY,k=1<d.targetTouches.length):(h=d.clientX,p=d.clientY);var n=d.target.getBoundingClientRect();h-=n.left;p-=n.top;h=e.te/b.offsetWidth*h|0;p=e.ve/b.offsetHeight*p|0;var t=h-e.wf;var q=p-e.xf;var r=n=!1;var w=h>=e.ad&&h<e.ad+e.se&&p>=e.bd&&p<e.bd+e.ue;if(0<=t&&t<e.Za&&0<=q+e.Wc||w)if(k||a.K||d.preventDefault(),0<=t&&t<e.Za&&
0<=q&&q<e.ib){r=!0;d=e.Za/e.$a|0;var u=e.ib/e.mb|0,A=t/d|0,B=q/u|0;!a.U||B&1||(t-=d>>1,A=t/d|0,A==e.$a-1&&(t=-1));u=B*u+(e.Wc>>1);t-=A*d+(e.re>>1);q-=u;0<=t&&t<e.Uc&&0<=q&&q<e.Vc&&(f=A,g=B,n=!0)}}t=t||0;q=q||0;d=b.offsetWidth;b=b.offsetHeight;if(c==Vb||c==Xb)for(A=0;A<a.H.length;A++)B=a.H[A],c==Xb?B.jb(B.id,!1):(u=q/(b/B.Sg|0)|0,(t/(d/B.Rg|0)|0)==B.ih&&u==B.jh&&B.jb(B.id,!0));if(!k)if(c==Vb)e.cb=h,e.rb=p,r?(Nb(a,f,g),n&&a.g&&Rb(a.time,a.R,a.g,!0)):w&&a.S.ka();else if(c==Wb)0<=e.cb&&0<=e.rb&&a.V?Nb(a,
f,g):a.v&&a.v(f,g);else if(c==Xb){if(c=a.g)c=a.time,f=a.R,c=c.a&&0<f&&f<=c.b.length?0<=c.b[f-1].va:!1;c||Nb(a,-1,-1);e.cb=e.rb=-1}else G(a,"unrecognized action: "+c)}function Nb(a,b,c){if(b!=a.I||c!=a.N)a.I=b,a.N=c,a.L&&a.L(b,c)}var Vb=1,Wb=2,Xb=3,Gb="surface",ac=3,Zb=170,bc=512,$b=3584,cc={},Yb=(cc[I.Zd]=2,cc[I.jd]=8,cc[I.cd]=32,cc[I.fc]=128,cc[I.ub]=bc,cc[I.Md]=1024,cc[I.Wd]=2048,cc);x.Input=Fb;
function dc(a,b,c){L.call(this,a,b,c,["color","backgroundColor"]);a=this.Y[ec];if(!a)throw Error("LED "+this.s.Y[ec]+" binding for '"+ec+"' missing");b=document.createElement("canvas");if(!b||!b.getContext)throw a.innerHTML="LED device requires HTML5 canvas support",Error("LED device requires HTML5 canvas support");this.oa=Ua(this,ec)+".canvas";b.setAttribute("id",this.oa);this.xa=a;this.type=Xa(H(this,"type",fc,gc),hc,ic);this.f=jc[this.type][0];this.j=jc[this.type][1];this.width=H(this,"width",
this.f,void 0);this.height=H(this,"height",this.j,void 0);this.g=H(this,"cols",1,void 0);this.H=this.g+H(this,"colsExtra",0,void 0);this.V=H(this,"rows",1,void 0);this.K=this.V+H(this,"rowsExtra",0,void 0);this.Z=this.width*this.g;this.N=this.height*this.V;this.i=kc("black",0);this.c=lc(this.s.color)||this.i;this.ga=kc(this.c,1,.25);this.fa=kc(this.c,1,2);this.h=lc(this.s.backgroundColor);this.ia=H(this,"fixed",!1);this.ia||(b.style.width="100%",b.style.height="auto");this.ea=H(this,"hexagonal",!1);
this.na=H(this,"highlight",!0);this.L=H(this,"persistent",this.type<ic);b.setAttribute("width",this.Z.toString());b.setAttribute("height",this.N.toString());b.style.backgroundColor=this.i;a.appendChild(b);this.ca=b.getContext("2d");if(this.m=document.createElement("canvas"))this.m.width=this.X=this.f*this.g,this.m.height=this.v=this.j*this.V,this.b=this.m.getContext("2d");this.qa=(this.K+1)*this.H*4;this.a=Array(this.qa);this.ra=this.g<this.H?4*(this.H-this.g):0;this.J=this.I=!1;this.u=this.U=0;this.R=
-1;var d=this;this.time=O(this,"Time");mc(this.time,function(e){nc(d,!1,e)});oc(d)}m(dc,L);function oc(a){for(var b=a.a,c=0;c<b.length;c+=4){var d=a,e=b,f=c;e[f]=d.type<ic?pc:" ";e[f+1]=d.c==d.i?null:d.c;e[f+2]=0;e[f+3]=qc}a.J=a.I=!0;nc(a,!0)}function rc(a){a.h?(a.b.fillStyle=a.h,a.b.fillRect(0,0,a.X,a.v)):a.b.clearRect(0,0,a.X,a.v)}
function nc(a,b,c){b=void 0===b?!1:b;c=void 0===c?0:c;if(a.J||b){if(a.type<ic){var d=0;if(!a.L||b)rc(a);else if(a.u){d=a.g-a.u;var e=a.f*d;a.b.drawImage(a.m,a.f*a.u,0,e,a.v,0,0,e,a.v)}for(var f=e=0;f<a.K;f++){for(var g=0;g<a.g;g++){var k=a.a[e],h=a.a[e+1]||a.i,p=a.na&&e==a.R;if(a.a[e+3]&qc||p||b){if(g>=d)a:{var n=a,t=k;k=h;var q=g;h=f;var r=p;q=void 0===q?0:q;h=void 0===h?0:h;r=void 0===r?!1:r;var w=0;if(n.ea&&!(h&1)&&(w=n.f>>1,q==n.g-1))break a;if(k&&k!=n.c){r=r?kc(k,1,2):k;var u=kc(k,1,.25)}else r=
r?n.fa:n.c,u=n.ga;k=!1;t=t?r:u;r==n.i&&(t=n.h,k=!0);r=q*n.f+w;u=h*n.j;n.L&&(q=q*n.f+w,h*=n.j,n.h?(n.b.fillStyle=n.h,n.b.fillRect(q,h,n.f,n.j)):n.b.clearRect(q,h,n.f,n.j));n.b.fillStyle=t;h=sc[n.type];3==h.length?(n.b.beginPath(),n.b.arc(r+h[0],u+h[1],h[2],0,2*Math.PI),k?(n.b.globalCompositeOperation="destination-out",n.b.fill(),n.b.globalCompositeOperation="source-over"):n.b.fill()):n.b.fillRect(r+h[0],u+h[1],h[2],h[3])}a.a[e+3]=p?a.a[e+3]|qc:a.a[e+3]&~qc}e+=4}e+=a.ra}a.u=0}else{b="";for(d=0;d<a.a.length;d+=
4)b+=a.a[d]||" ",a.a[d+3]&tc&&(b+=".");rc(a);for(f=e=d=0;d<b.length;d++){h=b[d];"."==h&&e&&e--;g=a;p=e;n=f;p=void 0===p?0:p;n=void 0===n?0:n;if(h=uc[h])for(k=0;k<h.length;k++)if(q=g,w=vc[h[k]]){t=(void 0===p?0:p)*q.f;r=(void 0===n?0:n)*q.j;q.b.fillStyle=q.c;q.b.beginPath();if(3==w.length)q.b.arc(t+w[0],r+w[1],w[2],0,2*Math.PI);else for(u=0;u<w.length;u+=2)u?q.b.lineTo(t+w[u],r+w[u+1]):q.b.moveTo(t+w[u],r+w[u+1]);q.b.closePath();q.b.fill()}if(++e==a.g&&(e=0,++f==a.K))break}}a.ca.globalCompositeOperation=
a.h&&a.c!=a.i?"source-over":"copy";a.ca.drawImage(a.m,0,0,a.X,a.v,0,0,a.Z,a.N);a.J=!1;a.R=-1}else a.L||a.I||(!c||!a.U||c-a.U>=(1E3/60|0))&&oc(a);a.I=!1;c&&(a.U=c)}function lc(a){return(a=a||void 0)&&rb[a]||a}
function kc(a,b,c){b=void 0===b?1:b;c=void 0===c?1:c;if(a){var d=[];a=rb[a]||a;var e=16;var f=a.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);f||(e=10,f=a.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+|)\)$/i));if(f){var g;for(g=1;g<f.length;g++)d[g-1]=Number.parseInt(f[g],e);d.length=g-1;e=!0}else e=!1;if(e){a="rgba(";for(e=0;3>e;e++)f=Math.round(d[e]*c),f=0>f?0:255<f?255:f,a+=f+",";a+=(e<d.length?d[e]:b)+")"}}return a}
dc.prototype.sa=function(a){var b=a.shift(),c=a.shift();a=a.shift();if(b==this.c&&c==this.h&&a&&a.length==this.a.length){this.a=a;for(b=0;b<=this.a.length-4;b+=4)this.a[b+1]==this.i&&(this.a[b+1]=null);nc(this,!0);return!0}return!1};dc.prototype.ta=function(a){this.a&&(a.push(this.c),a.push(this.h),a.push(this.a))};
var hc=0,fc=1,ic=3,gc={small:hc,round:fc,square:2,digit:ic},ec="container",pc=0,tc=1,qc=128,wc={},sc=(wc[hc]=[4,4,4],wc[fc]=[16,16,14],wc[2]=[2,2,28,28],wc),jc=[[8,8],[32,32],[32,32],[96,128]],vc={A:[30,8,79,8,67,19,37,19],B:[83,10,77,52,67,46,70,22],C:[77,59,71,100,61,89,64,64],D:[28,91,58,91,69,104,15,104],E:[18,59,28,64,25,88,12,100],F:[24,10,34,21,31,47,18,52],G:[24,56,34,50,60,50,71,56,61,61,33,61],P:[80,102,8]},uc={" ":[],0:"ABCDEF".split(""),1:["B","C"],2:["A","B","D","E","G"],3:["A","B","C",
"D","G"],4:["B","C","F","G"],5:["A","C","D","F","G"],6:"ACDEFG".split(""),7:["A","B","C"],8:"ABCDEFG".split(""),9:"ABCDFG".split(""),A:"ABCEFG".split(""),B:["C","D","E","F","G"],C:["A","D","E","F"],D:["B","C","D","E","G"],E:["A","D","E","F","G"],F:["A","E","F","G"],"-":["G"],".":["P"]};x.LED=dc;
function xc(a,b,c){L.call(this,a,b,c);this.ga=H(this,"cyclesMinimum",1E5,void 0);this.qa=H(this,"cyclesMaximum",1E9,void 0);this.X=Xa(H(this,"cyclesPerSecond",1E6,void 0),this.ga,this.qa);this.L=1E3/60;this.ra=H(this,"updatesPerSecond",2,void 0)||2;this.Ua=1E3/this.ra;this.oa=0;this.Va=H(this,"timeLock",!0);this.fa=this.H=0;this.ea=this.g=1;this.na=this.i=this.X/1E4/100;this.Z=[];this.v=[];this.b=[];this.U=[];this.ia=this.a=this.K=this.m=!1;this.u=this.f=0;a=Sa("requestAnimationFrame");if(!a){a="setTimeout";
var d=this.L}this.xa=window[a].bind(window,this.Ze.bind(this),d);this.Na=window[Sa("cancelAnimationFrame")||"clearTimeout"].bind(window);this.R=this.N=this.h=this.c=this.V=0;yc(this)||zc(this,this.ea)}m(xc,L);function mc(a,b){a.Z.push(b)}l=xc.prototype;
l.Ia=function(a,b){var c=this;switch(a){case Ac:b.onclick=function(){Bc(c)&&(c.a?Cc(c):c.start())};break;case Dc:b.onclick=function(){zc(c,c.g<<1);Ec(c,Fc(c.i))};break;case Gc:b.onclick=function(){Hc(c)};break;case Ic:b.addEventListener("mousedown",function(){c.m=!0}),b.addEventListener("mouseup",function(){yc(c);c.m=!1}),b.addEventListener("mousemove",function(){c.m&&yc(c)}),b.addEventListener("change",function(){c.m=!0;yc(c);c.m=!1})}L.prototype.Ia.call(this,a,b)};
function Mb(a,b,c){var d=void 0===d?-1:d;var e=a.b.length+1;a.b.push({id:b,ke:c,lb:d,va:-1});0<=d&&Rb(a,e,d);return e}
function Jc(a,b,c,d){var e=0,f=a.i,g=1E6*f;b&&c&&(f=b/(10*c)/100,a.l(v.gb,"calcSpeed(%d cycles, %5.3fms): %5.3fMhz\n",b,c,f),d>a.L&&(1<a.g&&(a.g>>=1,a.l(v.hb,"warning: frame time (%5.3fms) exceeded maximum (%5.3fms), target multiplier now %d\n",d,a.L,a.g)),e=d));a.H=f;a.fa=f/a.na;b=a.fa/a.g;a.V=g/b/60+1E-8;a.l(v.gb,"nCyclesDepositPerFrame(%5.3f) = nCyclesPerSecond(%d) / nDivisor(%5.3f) / nFramesPerSecond(%d)\n",a.V,g,b,60);return e}
function Kc(a,b){a.N=a.h=b;if(!a.v.length)return a.h=0,a.N;for(var c=0;0<a.h;){if(c<a.v.length){var d=a.v[c++];b=d.af.call(d,b)||1}else c=b=0;a.h-=b}return a.N-a.h}function Lc(a,b){b=void 0===b?a.N-a.h:b;if(!a.a){if(a.c)for(var c=0;c<a.v.length;c++){var d=a.v[c];d.bf.call(d)}a.c=b}a.c-=b;1>a.c&&(a.K=!0);a.R+=b;a.N=a.h=0;a.a||(a.R=0);return b}
function Mc(a,b){b=void 0===b?0:b;if(b){var c=b;a.c+=b}else for(c=a.c,1>c&&(c=a.c+=a.V),0>c&&(a.l(v.hb,"warning: cycle count dropped below zero: %f\n",c),c=a.c=0),c|=0,b=a.b.length;0<b;b--){var d=a.b[b-1];!(0>d.va)&&c>d.va&&(c=d.va)}return c}function Fc(a){1<=a?a=a.toFixed(2)+"Mhz":(a=Math.round(1E6*a),a=999>=a?a+"Hz":Math.ceil(a/1E3)+"Khz");return a}function Nc(a){a.l(v.gb,"getSpeedCurrent(%5.3fhz)\n",1E6*a.H);return a.a&&a.H?Fc(a.H):"Stopped"}
function Bc(a){return a.ia?!0:(G(a,"not powered"),!1)}function Oc(a,b){if(1<=b)for(var c=a.b.length;0<c;c--){var d=a.b[c-1];0>d.va||(d.va-=b,0>=d.va&&(d.va=-1,d.ke(),0<=d.lb&&Rb(a,c,d.lb)))}}l.ka=function(a){this.ia=a;void 0===this.W&&(this.W=O(this,"Debugger",!1))&&this.W.Hb(this,"time","dump time state",this.ze)};function Hc(a,b){Bc(a)&&(a.a?G(a,"already running"):a.f?Cc(a):Pc(a,b))}
l.Ze=function(a){a=void 0===a?Date.now():a;this.u=0;if(this.a){var b=Date.now();if(this.J){var c=b-this.I-this.L;c>this.L&&(this.j+=c,this.l(v.hb,"warning: browser throttling detected, compensating by %5.3fms\n",c))}this.I=b;this.j||(this.j=b);this.ca=0;try{this.K=!1;do Oc(this,Lc(this,Kc(this,Mc(this))));while(this.a&&!this.K)}catch(d){G(this,d.message),Cc(this)}this.J=Date.now();this.ca&&(this.j+=this.ca,this.I+=this.ca);this.I+=Jc(this,this.R,this.J-this.j,this.J-this.I);this.J-this.oa>=this.Ua&&
this.update();for(b=0;b<this.Z.length;b++)this.Z[b](a);this.u=this.xa()}};function zc(a,b){if(void 0!==b){if(1>b||!a.m&&0<a.H&&a.H<.9*a.i)b=a.ea;a.g=b;b=a.na*a.g;a.i!=b&&(a.i=b,Ec(a,Fc(a.i)))}a.j=a.J=0;a.c=a.R=0;Jc(a);for(b=a.b.length;0<b;b--){var c=a.b[b-1];0<=c.lb&&Rb(a,b,c.lb,!0)}}function yc(a){var b=a.Y[Ic];return b?(zc(a,Math.floor((b.value-b.min)/(b.max-b.min)*(a.qa-a.ga)+a.ga)/a.X|0),!0):!1}
function Rb(a,b,c,d){0<b&&b<=a.b.length&&(b=a.b[b-1],d||0>b.va)&&(c=Math.ceil(a.X*(a.Va?a.ea:a.fa)/1E3*(void 0===c?1E3:c)),a.a&&(c+=Lc(a)),b.va=c)}l.start=function(){if(this.a||this.f)return!1;this.a=!0;this.j=this.J=0;this.update(!0);this.u=this.xa();return!0};function Pc(a,b){b=void 0===b?1:b;a.a||(b&&!a.f&&(a.f=b),a.f&&(a.f--,Oc(a,Lc(a,Kc(a,Mc(a,1)))),a.update(!1),a.f&&setTimeout(function(){Pc(a,0)},0)))}
function Cc(a){return a.a?(a.a=!1,Lc(a),a.u&&(a.Na(a.u),a.u=0),a.update(!0),!0):a.f?(a.f=0,a.update(!0),!0):!1}l.update=function(a){a&&G(this,this.a?"started with "+Fc(this.i)+" target":"stopped");lb(this,Ac,this.a?"Halt":"Run");lb(this,Gc,this.f?"Stop":"Step");this.m||Ec(this,Nc(this));for(var b=0;b<this.U.length;b++){var c=this.U[b];c.Zc.call(c,void 0!=a)}this.oa=Date.now();this.K=!0};function Ec(a,b){lb(a,Qc,b);lb(a,Dc,b)}
l.ze=function(){var a=this.w("nCyclesPerSecond: %f\n",this.X);a+=this.w("nUpdatesPerSecond: %f\n",this.ra);a+=this.w("nTargetMultiplier: %f\n",this.g);return a+=this.w("nCyclesDepositPerFrame: %f\n",this.V)};var Ac="run",Dc="setSpeed",Qc="speed",Gc="step",Ic="throttle";x.Time=xc;
function Rc(a,b,c){L.call(this,a,b,c);this.type="static"==this.s.type?Sc:Tc;this.$=this.s.addrWidth||16;this.i=Math.pow(2,this.$);this.h=this.i-1|0;this.f=this.s.blockSize||(16<this.$?4096:1024);this.f>this.i&&(this.f=this.i);this.H=this.i/this.f|0;this.b=Math.log2(this.f)|0;this.c=(1<<this.b)-1;this.g=this.s.dataWidth||8;this.u=Math.pow(2,this.g)-1;this.j=!1!==this.s.littleEndian;this.a=Array(this.H);this.m=0;this.v=null;a=new P(a,b+"[NONE]",{size:this.f,bus:this.M});for(b=0;b<this.i;b+=this.f)Uc(this,
b,this.f,Q.NONE,a);Vc(this,this.type)}m(Rc,L);function Uc(a,b,c,d,e){for(var f=b>>>a.b;0<c&&f<a.a.length;){var g=f*a.f,k=a.f-(b-g);k>c&&(k=c);var h=a.a[f];if(b!=g||k!=a.f||h&&h.type!=Q.NONE)break;h=a.M+"["+z(a,b,16,a.$)+"]";b=e?e.size==a.f?e:new P(a.T,h,{type:d,da:b,size:k,bus:a.M}):new P(a.T,h,{type:d,da:b,size:k,bus:a.M});a.a[f]=b;b=g+a.f;c-=k;f++}}function Wc(a,b){for(var c=Q.Td,d=0,e=0;e<a.a.length;e++){var f=a.a[e];f&&f.type&c&&(b(f),d++)}return d}
function Xc(a,b,c){if(!(b&a.c)){b>>>=a.b;var d=a.a[b];a.a[b]=c}return d}function Yc(a,b,c){a.W&&a.W.l(v.nc,"bus fault (%d) at %n\n",c,b);a.v&&a.v(b,c)}l=Rc.prototype;l.ka=function(){void 0===this.W&&(this.W=O(this,"Debugger",!1))};l.la=function(){};l.Lb=function(a){return a&&this.sa(a)?!0:!1};l.ab=function(a){this.ta(a)};l.sa=function(a){for(var b=0;b<this.a.length;b++){var c=this.a[b];if((this.type==Tc||c.type&Q.Oa)&&c.sa){var d=a.shift();if(!c.sa(d))return!1}}return!0};
l.ta=function(a){for(var b=0;b<this.a.length;b++){var c=this.a[b];if((this.type==Tc||c.type&Q.Oa)&&c.ta){var d=[];c.ta(d);a.push(d)}}};l.Nb=function(a){return this.a[a>>>this.b].Nb(a&this.c)};l.ed=function(a){return this.a[a>>>this.b].wa(a&this.c)};l.bb=function(a,b){this.a[a>>>this.b].bb(a&this.c,b)};l.Ba=function(a,b){this.a[a>>>this.b].ua(a&this.c,b)};l.$b=function(a){return a&1?this.wa(a+1&this.h)|this.wa(a)<<this.g:this.a[a>>>this.b].ha(a&this.c)};
l.ac=function(a){return a&1?this.wa(a)|this.wa(a+1&this.h)<<this.g:this.a[a>>>this.b].ha(a&this.c)};l.He=function(a){return(a&this.c)==this.c?this.j?this.ac(a):this.$b(a):this.a[a>>>this.b].ha(a&this.c)};l.bc=function(a,b){a&1?(this.ua(a,b>>this.g),this.ua(a+1&this.h,b&this.u)):this.a[a>>>this.b].ba(a&this.c,b)};l.cc=function(a,b){a&1?(this.ua(a,b&this.u),this.ua(a+1&this.h,b>>this.g)):this.a[a>>>this.b].ba(a&this.c,b)};
l.df=function(a,b){(a&this.c)==this.c?this.j?this.cc(a,b):this.bc(a,b):this.a[a>>>this.b].ba(a&this.c,b)};function Vc(a,b){var c=a.m;a.m+=b;c&&a.m||(a.wa=a.ed,a.ua=a.Ba,a.type==Tc?(a.ha=a.He,a.ba=a.df):a.j?(a.ha=a.ac,a.ba=a.cc):(a.ha=a.$b,a.ba=a.bc))}l.nb=function(a,b){return this.a[a>>>this.b].nb(b)?(Vc(this,1),!0):!1};l.Qb=function(a,b){return this.a[a>>>this.b].Qb(b)?(Vc(this,1),!0):!1};l.ob=function(a,b){return this.a[a>>>this.b].ob(b)?(Vc(this,-1),!0):!1};
l.Sb=function(a,b){return this.a[a>>>this.b].Sb(b)?(Vc(this,-1),!0):!1};var Sc=0,Tc=1;x.Bus=Rc;
function P(a,b,c){L.call(this,a,b,c);this.da=this.s.addr;this.size=this.s.size;this.type=this.s.type||Q.NONE;this.f=(a=this.s.bus)?ub(this,a):O(this,a="Bus");if(!this.f)throw Error(this.w("unable to find bus '%s'",a));this.a=this.f.g;this.c=Math.pow(2,this.a)-1;this.U=this.X=!1;this.g=!1!==this.f.j;this.values=this.V=this.v=this.R=null;a=this.Ma;b=this.Ba;c=this.g?this.Je:this.Ie;var d=this.g?this.ff:this.ef;this.f.type==Sc&&(b=this.qf,c=this.g?this.Kd:this.Jd,d=this.rf,8==this.a&&!1!==yb(this,"ArrayBuffer")&&
(this.X=!0,c=this.g==ua?this.Se:this.Te));switch(this.type){case Q.NONE:this.wa=this.Ka;this.ua=this.Da;this.ha=this.Ke;this.ba=this.gf;break;case Q.Cc:this.wa=a;this.ua=this.Da;this.ha=c;this.ba=this.Da;break;case Q.Oa:this.wa=a,this.ua=b,this.ha=c,this.ba=d}this.H=this.h=0;this.N=this.i=this.L=this.J=this.j=this.m=null;Zc(this,this.s.values);$c(this)}m(P,L);
function Zc(a,b){"string"==typeof b?(Bb(a,!1),Za(b,function(c,d,e,f){if(4==e)if(!f&&d){try{var g=JSON.parse(d);Zc(a,g.values)}catch(k){a.l("error (%s) parsing resource: %s\n",k.message,c)}Bb(a,!0)}else a.l("error (%d) loading resource: %s\n",f,c)})):a.s.values=b}
function $c(a,b){if(a.type>Q.NONE&&(a.X?(a.v=new ArrayBuffer(a.size),a.R=new DataView(a.v,0,a.size),a.values=new Uint8Array(a.v,0,a.size),a.V=new Uint16Array(a.v,0,a.size>>1),new Int32Array(a.v,0,a.size>>2)):a.values=Array(a.size).fill(0),b))for(var c=0;c<b.length;c++)a.values[c]=b[c]}l=P.prototype;
l.la=function(){if(this.s.values)a:{var a=this.f,b=this.da,c=this.size,d=this.s.values,e=0,f=b&a.c;b>>>=a.b;c>d.length&&(c=d.length);for(;0<c&&b<a.a.length;){var g=a.a[b++];if(!g)break a;for(;0<c&&f<g.size;)g.Ba(f++,d[e++]),c--;f=0}}else this.type&Q.Oa&&this.values&&this.values.fill(0)};l.Ka=function(){return this.c};l.Ke=function(a){return this.g?this.Ka(a)|this.Ka(a+1)<<this.a:this.Ka(a+1)|this.Ka(a)<<this.a};l.Nb=function(a){return this.values?this.values[a]:0};l.Ma=function(a){return this.values[a]};
l.Jd=function(a){return this.values[a+1]|this.values[a]<<this.a};l.Kd=function(a){return this.values[a]|this.values[a+1]<<this.a};l.Se=function(a){return this.V[a>>>1]};l.Te=function(a){return this.R.getUint16(a,this.g)};l.Ie=function(a){return this.Ma(a+1)|this.Ma(a)<<this.a};l.Je=function(a){return this.Ma(a)|this.Ma(a+1)<<this.a};l.Da=function(){};l.gf=function(a,b){this.g?(this.Da(a,b&this.c),this.Da(a+1,b>>this.a)):(this.Da(a,b>>this.a),this.Da(a+1,b&this.c))};
l.bb=function(a,b){this.values&&(this.values[a]=b)};l.Ba=function(a,b){this.values[a]=b};l.qf=function(a,b){this.values[a]=b;this.U=!0;this.h?this.J=this.Ba:this.ua=this.Ba};l.wb=function(a,b){this.values[a]=b>>this.a;this.values[a+1]=b&this.c};l.xb=function(a,b){this.values[a]=b&this.c;this.values[a+1]=b>>this.a};l.Tb=function(a,b){this.V[a>>>1]=b};l.Ub=function(a,b){this.R.setUint16(a,b,this.g)};l.ef=function(a,b){this.Ba(a,b>>this.a);this.Ba(a+1,b&this.c)};
l.ff=function(a,b){this.Ba(a,b&this.c);this.Ba(a+1,b>>this.a)};l.rf=function(a,b){this.v?this.g==ua?(this.Tb(a,b),this.h?this.i=this.Tb:this.ba=this.Tb):(this.Ub(a,b),this.h?this.i=this.Ub:this.ba=this.Ub):this.g?(this.xb(a,b),this.h?this.i=this.xb:this.ba=this.xb):(this.wb(a,b),this.h?this.i=this.wb:this.ba=this.wb)};
l.nb=function(a){if(!this.H){var b=this;this.H++;this.j=a;this.L=this.wa;this.N=this.ha;this.wa=function(c){var d=b.L(c);b.j(b.da,c,d);return d};this.ha=function(c){var d=b.N(c);b.j(b.da,c,d);b.j(b.da,c+1,d);return d};return!0}return this.j==a?(this.H++,!0):!1};l.Qb=function(a){if(!this.h){var b=this;this.h++;this.m=a;this.J=this.ua;this.i=this.ba;this.ua=function(c,d){b.m(b.da,c,d);b.J(c,d)};this.ba=function(c,d){b.m(b.da,c,d);b.m(b.da,c+1,d);b.i(c,d)};return!0}return this.m==a?(this.h++,!0):!1};
l.ob=function(a){return this.H&&this.j==a?(--this.H||(this.wa=this.L,this.ha=this.N,this.L=this.N=this.j=null),!0):!1};l.Sb=function(a){return this.h&&this.m==a?(--this.h||(this.ua=this.J,this.ba=this.i,this.J=this.i=this.m=null),!0):!1};l.sa=function(a){var b=a.shift();if(this.M==b){this.U=a.shift();a.shift();if(a=a.shift()){var c=this.size;c=void 0===c?0:c;if(a.length!=c){b=0;c=c?Array(c):[];for(var d=0;d<a.length-1;)for(var e=a[d++],f=a[d++];e--;)c[b++]=f;a=c}$c(this,a)}return!0}return!1};
l.ta=function(a){a.push(this.M);a.push(this.U);a.push(!1);a.push(this.values?Aa(this.values):this.values)};var Q={NONE:1,Cc:2,Oa:4,Td:14,Ng:12};x.Memory=P;function ad(a,b,c){P.call(this,a,b,c);this.u=[];this.I=[];this.b=[];this.K=[];void 0!=this.s.addr&&Uc(this.f,this.s.addr,this.s.size,Q.NONE,this)}m(ad,P);
function bd(a,b,c,d,e,f,g,k){for(var h;c<=d;c++){h=!1;if(e){if(a.u[c])break;a.u[c]=e.bind(b)}if(f){if(a.I[c])break;a.I[c]=f.bind(b)}if(g){if(a.b[c])break;a.b[c]=g.bind(b)}if(k){if(a.K[c])break;a.K[c]=k.bind(b)}h=!0}if(!h)throw Error(a.w("handler for port %#0x already exists",c));}function cd(a,b,c){var d=void 0===d?0:d;for(var e in c){var f=c[e];bd(a,b,+e+d,+e+d,f[0],f[1],f[2],f[3])}}
ad.prototype.Ka=function(a){var b,c=this.da+a;if(b=this.u[c]){var d=b(c);var e=!0}else if(b=this.b[c])d=c&1?b(c&-2)>>this.a:b(c)&this.c,e=!0;else if(c&1)if(c&=-2,b=this.b[c])d=b(c)>>this.a,e=!0;else if(b=this.u[c])d=b(c),e=!0;e||(Yc(this.f,c,0),this.l(v.yb+v.vb,"readNone(%#04x): unknown port\n",c),d=P.prototype.Ka.call(this,a));return d};
ad.prototype.Da=function(a,b){var c,d=this.da+a;if(c=this.I[d]){c(d,b);var e=!0}else if(c=this.K[d])e=this.b[d]?this.b[d](d,!0):0,d&1?c(d,e&this.c|b<<this.a):c(d,e&~this.c|b),e=!0;else if(d&1)if(d&=-2,c=this.K[d])e=this.b[d]?this.b[d](d,!0):0,c(d,e&this.c|b<<this.a),e=!0;else if(c=this.I[d])c(d,b),e=!0;e||(Yc(this.f,d,1),this.l(v.yb+v.vb,"writeNone(%#04x,%#04x): unknown port\n",d,b),P.prototype.Da.call(this,a,b))};x.Ports=ad;
function dd(a,b,c){c.type=Q.NONE;P.call(this,a,b,c);Uc(this.f,this.s.addr,this.s.size,Q.Oa);Cb(this,this.la.bind(this))}m(dd,P);x.RAM=dd;
function ed(a,b,c){c.type=Q.Cc;P.call(this,a,b,c);Uc(this.f,this.s.addr,this.s.size,this.s.type,this);Cb(this,this.la.bind(this));this.o=this.W=void 0;if(x.LED&&this.Y[fd]){var d=this;this.u=Math.pow(2,Math.ceil(Math.log2(this.values.length)/2));this.I=this.values.length/this.u|0;this.b=new dc(a,b+"LEDs",{"class":"LED",bindings:{container:Ua(this,fd)},type:fc,cols:this.u,rows:this.I,color:H(this,"colorROM","green"),backgroundColor:H(this,"backgroundColorROM","black"),persistent:!0}),oc(this.b);this.K=
new Fb(a,b+"Input",{"class":"Input",location:[0,0,this.b.Z,this.b.N,this.u,this.I],bindings:{surface:Ua(this,fd)}});this.Z=Va(this)||"";Ib(this.K,function(e,f){if(d.o){var g=d.Z;0<=e&&0<=f&&(e=f*d.u+e,f=d.o,g=f.W&&gd(f.W,d.da+e,1)||"");lb(d,Wa,g)}})}}m(ed,P);
ed.prototype.sa=function(a){var b=!0,c=a.shift();if(c&&this.b){var d=c.length;this.b.a.length==d?(this.b.a=c,nc(this.b,!0)):(this.l("inconsistent saved LED state (%d), unable to load\n",d),b=!1)}a.length&&(d=(a=a.shift())&&a.length||-1,this.values.length==d?this.values=a:(this.l("inconsistent saved ROM state (%d), unable to load\n",d),b=!1));return b};ed.prototype.ka=function(){void 0===this.o&&(this.o=O(this,"CPU"));void 0===this.W&&(this.W=O(this,"Debugger",!1))&&this.W.Ib&&this.W.Ib(this.s.symbols)};
ed.prototype.Ma=function(a){if(this.b){var b=this.b,c=qc;c=(void 0===c?0:c)&129;var d=4*((a/this.u|0)*b.H+a%this.u);if(d<=b.a.length-4){if(1!==b.a[d]||(b.a[d+3]&129)!==c)b.a[d]=1,b.a[d+3]=b.a[d+3]&-130|c|qc,b.J=!0;b.R=d;b.I=!0;b.u=0}}return this.values[a]};ed.prototype.ta=function(a){this.b&&(a.push(this.b.a),a.push(this.values))};var fd="array",Wa="cellDesc";x.ROM=ed;
function hd(a,b,c){c["class"]="CPU";L.call(this,a,b,c);this.W=void 0;this.Cb=this.Ob=0;this.time=O(this,"Time");this.time.v.push(this);this.time.U.push(this);this.ga=this.V=0}m(hd,L);hd.prototype.abort=function(a){this.Cb=this.Ob;G(this,a.message);Cc(this.time)};function id(a,b){a.W=b;return a.Fa}hd.prototype.af=function(a){this.ga=this.V=void 0===a?0:a;return this.ga-this.V};hd.prototype.bf=function(){this.ga-=this.V;this.V=0};
function jd(a,b,c){c["class"]="Debugger";L.call(this,a,b,c);var d=this;this.aa=this.s.defaultRadix||16;this.ea=1;this.R=["(",")"];Ca(this,"a",function(f,g,k,h,p){return z(d,p.O,d.aa,k)});Ca(this,"n",function(f,g,k,h,p){return z(d,p,d.aa,k,0>g.indexOf("#")?"":void 0)});this.v=0;this.fa=v.NONE;this.H={};this.ga=[];this.ia=[];this.o=O(this,"CPU");this.Fa=id(this.o,this);this.na=O(this,"Input",!1);if(a=this.o.s.busMemory||this.s.busMemory){this.a=ub(this,a);if(a=this.o.s.busIO||this.s.busIO)this.f=ub(this,
a,!1);this.f||(this.f=this.a)}else this.a=this.f=O(this,"Bus");this.u=this.a.$;this.xa=Math.pow(2,this.u)-1|0;this.j=this.Z=0;this.i=[];for(var e in S)this.i[S[e]]=[];this.h=[];this.h[S.za]=this.a;this.h[S.Ya]=this.a;this.h[S.Ca]=this.f;this.h[S.Sa]=this.f;this.g=[];this.g[S.za]=this.ne.bind(this);this.g[S.Ya]=this.qe.bind(this);this.g[S.Ca]=this.le.bind(this);this.g[S.Sa]=this.me.bind(this);this.c=[];this.I=void 0;this.N=null;this.U=0;this.time=O(this,"Time");this.time.U.push(this);this.V=0;this.m=
[];this.L="";this.Hb(this,"state","dump machine state",this.ye);this.X=kd();this.oa=kd();this.ca=!1;this.K=0;this.b=[];Pa(this,this.De.bind(this));(e=yb(this,"commands"))&&eb(this,e)}m(jd,L);l=jd.prototype;l.Hb=function(a,b,c,d){this.m.push({xe:a,name:b,we:c,jb:d})};function ld(a,b,c){for(var d,e=0;e<a.m.length;e++){var f=a.m[e];if(f.name==b){d=f.jb.call(f.xe,c);break}}return d}
l.Ib=function(a){if(a&&a.length)for(var b=0;b<a.length-2;b+=3){var c=md(this,a[b]);if(c){var d=nd[a[b+1]];if(d){c={Ja:c,type:d,name:a[b+2]};d=this.ga;var e=c,f=od(d,e,this.Sc);0>f&&d.splice(-(f+1),0,e);d=this.ia;e=od(d,c,this.Tc);0>e&&d.splice(-(e+1),0,c)}}}};function od(a,b,c){var d=0,e=a.length,f=0;for(void 0===c&&(c=function(h,p){return h>p?1:h<p?-1:0});d<e;){var g=d+e>>1,k=void 0;k=c(b,a[g]);0<k?d=g+1:(e=g,f=!k)}return f?d:~d}l.Sc=function(a,b){return a.name>b.name?1:a.name<b.name?-1:0};
l.Tc=function(a,b){return a.Ja.O>b.Ja.O?1:a.Ja.O<b.Ja.O?-1:0};function pd(a,b,c){b=od(a.ia,{Ja:b,type:0,name:void 0},a.Tc);if(0<=b&&(a=a.ia[b],!c||a.type==c))var d=a.name;return d}function qd(a,b,c,d){d=void 0===d?a.a:d;b.O=b.O+c&d.h}function kd(a){a=void 0===a?0:a;var b=rd.Qd;return"number"==typeof a?{O:a,Pb:-1,type:b}:{O:a.O,Pb:a.Pb,type:a.type}}
function md(a,b,c){if(b){var d=kd();var e=0,f=b.charAt(e);switch(f){case "&":e++;break;case "#":e++;d.type=rd.Rd;break;case "%":e++,f=b.charAt(e),"%"==f?e++:d.type=rd.Ic}f=b.indexOf(":",e);if(0<=f){var g=sd(a,b.substring(e,f),c);void 0==g?d=null:(d.Pb=g,e=f+1)}d&&(b=sd(a,b.substring(e),c),void 0==b?d=null:d.O=b&a.xa)}return d}function td(a,b,c,d){d=void 0===d?a.a:d;a.j++;var e=d.Nb(b.O);c&&qd(a,b,c,d);a.j--;return e}
function ud(a,b,c){if(32>=a.u)return b&c;b=T(a,b,0,!0);c=T(a,c,0,!0);return((b/D|0)&(c/D|0))*D+((b&c)>>>0)}function vd(a,b,c){if(32>=a.u)return b^c;b=T(a,b,0,!0);c=T(a,c,0,!0);return((b/D|0)^(c/D|0))*D+((b^c)>>>0)}
function wd(a,b,c,d){for(d=void 0===d?-1:d;d--&&c.length;){var e=c.pop();if(2>b.length)return!1;var f=b.pop();var g=b.pop();switch(e){case "*":g*=f;break;case "/":if(!f)return!1;g=Math.trunc(g/f);break;case "^/":if(!f)return!1;g%=f;break;case "+":g+=f;break;case "-":g-=f;break;case "<<":g<<=f;break;case ">>":g>>=f;break;case ">>>":g>>>=f;break;case "<":g=g<f?1:0;break;case "<=":g=g<=f?1:0;break;case ">":g=g>f?1:0;break;case ">=":g=g>=f?1:0;break;case "==":g=g==f?1:0;break;case "!=":g=g!=f?1:0;break;
case "&":g=ud(a,g,f);break;case "!":case "|":e=g;32>=a.u?g=e|f:(e=T(a,e,0,!0),f=T(a,f,0,!0),g=(e/D|0|f/D|0)*D+((e|f)>>>0));break;case "^!":g=vd(a,g,f);break;case "&&":g=g&&f?1:0;break;case "||":g=g||f?1:0;break;case ",,":g=T(a,g,18,!0)*Math.pow(2,18)+T(a,f,18,!0);break;case "_":case "^_":"^_"==e&&(f=35-(f&255));f&&(g=T(a,g,0,!0),g=0<f?g*Math.pow(2,f):Math.trunc(g/Math.pow(2,-f)));break;default:return!1}b.push(T(a,g))}return!0}
function xd(a,b,c,d,e,f){var g,k=!1,h=0,p=[],n=[],t=a.aa;for(a.aa=e;c<d;){var q=b[c++].trim();var r=c<d?b[c++]:"";if(q){var w=void 0;var u=a;var A=q,B=f;h=void 0===h?0:h;if(void 0!=A){w=zb(u,A.toUpperCase());if(void 0==w){w=void 0;var y=u,X=od(y.ga,{Ja:null,type:0,name:A},y.Sc);0<=X&&(w=y.ga[X].Ja.O);if(void 0==w)if(w=A,u.H[w]?w=u.H[w].value:(w=w.substr(0,6),w=u.H[w]&&u.H[w].value),void 0==w)w=ya(A,1<A.length||10<u.aa?u.aa:10);else if(A=u.H[A]&&u.H[A].eh)B?B.push(A):(B=sd(u,A,B),void 0!==B?w+=B:w=
void 0)}void 0!=w&&(w=T(u,yd(u,w,h)))}u=w}else if("{"==r){q=1;for(u=c;c<d;)if(c++,r=c<b.length?b[c++]:"","{"==r)q++;else if("}"==r&&!--q)break;u=xd(a,b,u,c-1,a.aa,f);null!=u&&h&&(u=yd(a,u,h));q=c<d?b[c++].trim():"";r=c<d?b[c++]:""}else{if(" "==r)continue;if("^B"==r){a.aa=2;continue}if("^O"==r){a.aa=8;continue}if("^D"==r){a.aa=10;continue}if(!(h&-1073741824)){if("+"==r)continue;if("-"==r){h=h<<2|1;continue}if("~"==r||"^-"==r){h=h<<2|2;continue}if("^L"==r){h=h<<2|3;continue}}k=!0;break}if(void 0===
u)if(f)f.push(q),u=0;else{k=!0;break}p.push(T(a,u));if(" "==r)if(c<b.length-1&&!b[c])c++,r=b[c++];else{k=!0;break}if(!r)break;u="<"==a.R[0]?zd:Ad;if(!u[r]){k=!0;break}n.length&&u[r]<=u[n[n.length-1]]&&wd(a,p,n,1);n.push(r);a.aa="^_"==r?10:e;h=0}if(k||!wd(a,p,n)||1!=p.length)k=!0;k?f||a.l("parse error (%s)\n",q||r):g=p.pop();a.aa=t;return g}
function Bd(a,b,c,d){for(var e,f=a.u/d|0;0<=(e=b.indexOf(c));){for(var g=0,k=e+1,h=f;k<b.length;){var p=b[k++];if(p==c){h=-1;break}if(!h)break;h--;p=p.charCodeAt(0);6==d&&(p-=32);p&=(1<<d)-1;g=T(a,g*Math.pow(2,d)+p,d*f,!0)}if(0<=h){a.l("parse error (%c%s%c)\n",c,b,c);return}b=b.substr(0,e)+z(a,g)+b.substr(k)}return b}
function sd(a,b,c){if(b){"{"!=a.R[0]&&(b=b.split(a.R[0]).join("{").split(a.R[1]).join("}"));b=Bd(a,b,'"',8);if(!b)return d;b=Bd(a,b,"'",6);if(!b)return d;16!=a.aa&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);var d=xd(a,b,0,b.length,a.aa,c)}return d}
function yd(a,b,c){for(;c;){var d;switch(c&3){case 1:b=-T(a,b);break;case 2:b=vd(a,b,-1);break;case 3:for(d=35;0<=d&&!ud(a,b,Math.pow(2,d));)d--;b=35-d}c>>>=2}return b}function T(a,b,c,d){var e=b;c=c||a.u;if(d)if(32==c)e=b>>>0;else if(32>c)e=b&(1<<c)-1;else{if(a=Math.pow(2,c),0>b||b>=a)e=b%a,0>e&&(e+=a)}else 32>=c?e=b<<32-c>>32-c:(a=Math.pow(2,c-1),b>=a?(e=b%a,(b/a|0)&1&&(e-=a)):b<-a&&(e=b%a,((-b-1)/a|0)&1?e&&(e+=a):e||(e-=a)));b!=e&&(b=e);return b}
l.Jb=function(a){function b(k){for(var h=0;h<k.length;h++)if(void 0!=k[h])return!1;return!0}if(-1>a)return Cd(this,this.Jb);var c="";if(0<=a){var d=this.c[a];if(void 0!=d){c=d>>8;d&=255;var e=this.h[c];if(e){var f=this.i[c],g=f[d];(c&1?e.Sb(g.O,this.g[c]):e.ob(g.O,this.g[c]))?(f[d]=void 0,this.c[a]=void 0,b(f)&&(f.length=0,b(this.c)&&(this.c.length=0)),c=this.w("%2d: %s %*a cleared\n",a,Dd[c],e.$,g),--this.Z||this.ca||(c+=Ed(this,!1))):c=this.w("invalid break address: %*a\n",e.$,g)}else c="invalid bus"}else c=
this.w("invalid break index: %d\n",a)}else c="missing break index\n";return c};function Fd(a,b){if(a.N&&(void 0==b||a.N.O==b)){var c=void 0===c?S.za:c;b=-1;var d=Gd(a.N,a.i[c]);if(0<=d)for(var e=0;e<a.c.length;e++){var f=a.c[e];if(void 0!=f&&c==f>>8&&d==(f&255)){b=e;break}}c=b;0<=c&&a.Jb(c);a.N=null}}
l.Kb=function(a,b){b=void 0===b?!1:b;if(-1>a)return Cd(this,this.Kb,b);if(0<=a){var c=this.c[a];if(void 0!=c){var d=c>>8;c=this.i[d][c&255];if(void 0!=c){var e=b?"enabled":"disabled",f=this.h[d];!c.disabled==!b?(c.disabled=!b,a=this.w("%2d: %s %*a %s\n",a,Dd[d],f.$,c,e)):a=this.w("%2d: %s %*a already %s\n",a,Dd[d],f.$,c,e)}else a=this.w("no break address at index: %d\n",a)}else a=this.w("invalid break index: %d\n",a)}else a="missing break index\n";return a};
function Cd(a,b,c){for(var d="",e=0;e<a.c.length;e++)void 0!=a.c[e]&&(d+=b.call(a,e,c));d||(d="no break addresses found");return d}function Hd(a,b,c){c=void 0===c?S.za:c;a=a.i[c];for(c=0;c<a.length;c++){var d=a[c];if(d.O==b)return d}}function Gd(a,b){for(var c=0;c<b.length;c++)if(b[c].O==a.O)return c;return-1}
function Id(a,b){b=void 0===b?!1:b;for(var c="",d=0;d<a.c.length;d++){var e=a.c[d];if(void 0!=e){var f=e>>8;e=a.i[f][e&255];f=a.w("%s %*a",Dd[f],a.h[f].$,e);b?(c&&(c+=";"),c+=f,e.disabled&&(c+=";bd "+d)):c+=a.w("%2d: %s %s\n",d,f,e.disabled?"disabled":"enabled")}}c||b||(c="no break addresses found\n");return c}
function Jd(a,b,c){c=void 0===c?S.za:c;if(b){var d=a.h[c];if(d){var e=a.i[c];var f=Gd(b,e);if(0<=f)f=-(f+1);else{for(f=0;f<e.length&&void 0!=e[f];f++);e[f]=b}e=f;if(0<=e)if(f=c&1?d.Qb(b.O,a.g[c]):d.nb(b.O,a.g[c])){for(f=0;f<a.c.length&&void 0!=a.c[f];f++);a.c[f]=c<<8|e;b=a.w("%2d: %s %*a set\n",f,Dd[c],d.$,b);a.Z++||a.b.length||(b+=Ed(a,!0))}else b=a.w("invalid break address: %*a\n",d.$,b),a.i[c][e]=void 0;else b=a.w("%s %*a already set\n",Dd[c],d.$,b)}else b="invalid bus"}else b="missing break address\n";
return b}function Kd(a,b){0<=b&&(a.v=b);var c="instruction break count: "+(0<a.v?a.v:"disabled")+"\n";0<b&&(a.b.length||(c+=Ed(a,!0)),a.ca=!0);return c}function Ld(a,b){var c;if(b){var d=fb(b);void 0!=d?a.fa=d?v.Xb:v.NONE:c=a.w("unrecognized message option: %s\n",b)}c||(c=a.w("break on message: %b\n",!!a.fa));return c}l.le=function(a,b){this.j||(void 0==a?Md(this,"break on unknown input %#0x: %#0x",b):(a=Hd(this,a+b,S.Ca))&&!a.disabled&&Md(this,"break on input %*a: %#0x",this.f.$))};
l.me=function(a,b){this.j||(void 0==a?Md(this,"break on unknown output %#0x: %#0x",b):(a=Hd(this,a+b,S.Sa))&&!a.disabled&&Md(this,"break on output %*a: %#0x",this.f.$))};l.ne=function(a,b){this.j||(void 0==a?Md(this,"break on unknown read %#0x: %#0x",b):(a+=b,this.b.length&&a==this.o.Ob&&(this.U++,0<this.v&&(--this.v||Md(this,"break on instruction count")),this.b[this.K++]=a,this.K==this.b.length&&(this.K=0)),(b=Hd(this,a,S.za))&&!b.disabled&&(Md(this,"break on read %*a: %#0x",this.a.$),Fd(this,a))))};
l.qe=function(a,b){this.j||(void 0==a?Md(this,"break on unknown write %#0x: %#0x",b):(a=Hd(this,a+b,S.Ya))&&!a.disabled&&Md(this,"break on write %*a: %#0x",this.a.$))};function Md(a,b,c){b=a.w.apply(a,[b].concat(ba(c)));G(a,b);Cc(a.time)}function Nd(a,b,c){c=void 0===c?a.a:c;return z(a,b.O,a.aa,c.$,"")}
function Od(a,b,c){c=void 0===c?10:c;var d="";if(a.b.length){var e,f=[];c>a.b.length&&(c=a.b.length);0>b&&(b=c);var g=a.K-b;for(0>g&&(g+=a.b.length);0<=g&&g<a.b.length&&0<c;){var k=a.b[g++];if(void 0==k)break;g==a.b.length&&(g=0);e?e.O=k:e=kd(k);for(k=0;k<a.ea;k++)f[k]=td(a,e,1);qd(a,e,-f.length);d+=a.Rb(e,f,a.w("[%6d]",b--));c--}}return d||"no history"}
function gd(a,b,c){var d=[],e="";for(b="number"==typeof b?kd(b):b;c--;){for(qd(a,b,d.length);d.length<a.ea;)d.push(td(a,b,1));qd(a,b,-d.length);e+=a.Rb(b,d)}return e}
function Pd(a,b,c,d,e,f){var g="";f=f?a.f:a.a;c||(c=f.g);var k=c>>3;d||(d=128);var h=0,p=d+15>>4||1,n=4==k?16:a.aa;"y"==e&&(n=k,p=d,h=8*k);b||(b=a.oa);for(;p--&&0<d;){var t=e=0,q,r="",w="",u=Nd(a,b,f);for(q=n;0<q&&0<d;q--){var A=td(a,b,1,f);e|=A<<(t++<<3);t==k&&(r+=z(a,e,0,c,""),r+=1==k?9==q?"-":" ":" ",h&&(w+=z(a,e,2,c,"")),e=t=0);h||(w+=32<=A&&127>A?String.fromCharCode(A):".");d--}g&&(g+="\n");g+=u+"  "+r+" "+w}a.oa=b;return g}
l.ye=function(){var a=[];xb(this,function(b){b.ab&&b.ab(a);return!0});return JSON.stringify(a,null,2)};function Qd(a,b,c,d){var e=0,f="";d=d?a.f:a.a;for(var g=0;void 0!=b&&g<c.length;g++){var k=td(a,b,0,d);if(void 0==k)break;var h=a,p=b,n=c[g],t=d;t=void 0===t?h.a:t;h.j++;t.bb(p.O,n);h.j--;f+=a.w("%*a: %#*n changed to %#*n\n",a.a.$,b,a.a.g,k,a.a.g,c[g]);qd(a,b,1,d);e++}e||(f+=a.w("%d locations updated\n",e));a.time.update();return f}
function Ed(a,b){var c="";void 0!=b&&b==!a.b.length&&Wc(a.a,function(d){b?a.a.nb(d.da,a.g[S.za]):a.a.ob(d.da,a.g[S.za])})&&(b?(a.K=0,a.b=Array(Rd)):a.b=[]);return c+=a.w("instruction history %s\n",a.b.length?"enabled":"disabled")}l.sa=function(a){var b=a.shift();return this.M==b?(eb(this,a.shift()),this.S.ja=a.shift(),!0):!1};l.Yc=function(a){za(this.fa,a)?Md(this,"break on message"):this.time.K=!0};
l.De=function(a){var b=a[1],c=a[2],d=[],e=[],f=!1,g="";this.I=void 0;if("*"==c)var k=-2;else{k=ya(c);void 0==k&&(k=-1);var h=md(this,c,e);if(null===h)return}var p=0;a[3]&&(p=ya(a[3].substr("l"==a[3][0]?1:0))||8);for(var n=3;n<a.length;n++)d.push(ya(a[n],16));if("d"==b){n=ld(this,c,d);if(void 0!=n)return n;b=this.L||b}if("s"!=b[0]&&e.length)return"unrecognized symbol(s): "+e;switch(b[0]){case "b":"c"==b[1]?g=this.Jb(k):"d"==b[1]?g=this.Kb(k):"e"==b[1]?g=this.Kb(k,!0):"i"==b[1]?g=Jd(this,h,S.Ca):"l"==
b[1]?g=Id(this):"m"==b[1]?g=Ld(this,c):"n"==b[1]?g=Kd(this,k):"o"==b[1]?g=Jd(this,h,S.Sa):"r"==b[1]?g=Jd(this,h,S.za):"w"==b[1]?g=Jd(this,h,S.Ya):"?"==b[1]?(g="break commands:\n",Sd.forEach(function(t){g+=t+"\n"})):b[1]&&(g=void 0);break;case "d":this.L=b;if("b"!=b[1]&&b[1])if("w"==b[1])c=16;else if("d"==b[1])c=32;else if("i"==b[1]){if(!this.f){g="invalid bus";break}c=this.f.g;p=p||1;f=!0}else{if("h"==b[1])this.L="",g=Od(this,k,p);else if("?"==b[1]){if(this.L="",g="dump commands:\n",Td.forEach(function(t){g+=
t+"\n"}),this.m.length)for(g+="dump extensions:\n",b=0;b<this.m.length;b++)h=this.m[b],g+=this.w("d   %-12s%s\n",h.name,h.we)}else this.L="",g=void 0;break}else c=8;g=Pd(this,h,c,p,b[2],f);break;case "e":if("o"==b[1]){if(!this.f){g="invalid bus";break}f=!0}else if(b[1]){g=void 0;break}g=Qd(this,h,d,f);break;case "g":if(this.time.start()){if(void 0!=h){Fd(this);g=Jd(this,h);if(2!=g.indexOf(":"))break;this.N=h;g=""}break}g="already started\n";break;case "h":Cc(this.time)||(g="already stopped\n");break;
case "p":a.shift();a.shift();b=a.join(" ");g+=this.w("%s = %s\n",b,z(this,sd(this,b)));break;case "r":if(b=b.substr(1).toUpperCase()){if(void 0==zb(this.o,b)){g+=this.w("unrecognized register: %s\n",b);break}void 0!=h&&Eb(this.o,b,h.O)}this.X.O=this.o.Cb;g+=this.o.toString();break;case "s":h=fb(c);if("h"==b[1]){if(this.Z||0<this.v)h=void 0;g=Ed(this,h);void 0!=h&&(this.ca=h)}else"p"==b[1]?0<k?(zc(this.time,k),g="target speed:  "+Fc(this.time.i)):g="current speed: "+Nc(this.time):"s"==b[1]&&this.ra?
(k=this.ra.indexOf(c),0<=k&&(this.style=this.ra[k]),g="style: "+this.style):"?"==b[1]?(g="set commands:\n",Ud.forEach(function(t){g+=t+"\n"})):g=void 0;break;case "t":p=ya(c,10)||1;this.I=!0;if(b[1]){if("r"!=b[1]){g=void 0;break}this.I=!1}Hc(this.time,p);break;case "u":if(b[1]){g=void 0;break}p||(p=8);h||(h=this.X);g+=gd(this,h,p);this.X=h;break;case "?":g="debugger commands:\n";Vd.forEach(function(t){g+=t+"\n"});break;default:g=void 0}void 0==g&&a[0]&&(g="unrecognized command '"+a[0]+"' (try '?')\n");
return g};l.Lb=function(a){return a&&this.sa(a[0])?(a.shift(),!0):!1};l.ab=function(a){var b=[];this.ta(b);a.push(b);this.V=0};l.Zc=function(a){if(a){if(this.time.a){if(this.V&&this.na){a=this.na;var b=a.c;b&&Ab(a.S)&&(a.l(v.Ca,'setFocus("%s")\n',b.id||b.nodeName),b.focus(),b.scrollIntoView())}}else this.I?this.Ha(gd(this,this.o.Cb,1)):(this.U&&(G(this.o,this.U+" instructions executed"),this.U=0),this.o.Ha(this.o.toString()),void 0==this.I&&this.V&&(a=this.Pa(Ma.fb,!0))&&a.focus());this.V++}};
l.ta=function(a){a.push(this.M);a.push(Id(this,!0));a.push(this.S.ja)};l.Rb=function(a,b,c){var d=this;return this.w("%s %02x       unsupported       ; %s\n",Nd(this,a),function(){var e=b.shift();qd(d,a,1);return e}(),c||"")};
var Vd="b?\t\tbreak commands;d?\t\tdump commands;e[o] [addr] ...\tedit memory/ports;g    [addr]\trun (to addr);h\t\thalt;p    [expr]\tparse expression;r?   [value]\tdisplay/set registers;s?\t\tset commands;t[r] [n]\tstep (n instructions);u    [addr] [n]\tunassemble (at addr)".split(";"),Sd="bc [n|*]\tclear break address;bd [n|*]\tdisable break address;be [n|*]\tenable break address;bl [n]\t\tlist break addresses;bi [addr]\tbreak on input;bo [addr]\tbreak on output;br [addr]\tbreak on read;bw [addr]\tbreak on write;bm [on|off]\tbreak on message;bn [count]\tbreak on instruction count".split(";"),
Td="db  [addr]\tdump bytes (8 bits);dw  [addr]\tdump words (16 bits);dd  [addr]\tdump dwords (32 bits);di  [addr]\tdump input ports;d*y [addr]\tdump values in binary;dh  [n] [l]\tdump instruction history buffer;ds\t\tdump machine state".split(";"),Ud=["sh [on|off]\tset instruction history","sp [n]\t\tset speed multiplier","ss\t\tset debugger style"],rd={Ic:1,Qd:0,Rd:2,Kg:0},S={za:0,Ya:1,Ca:2,Sa:3},Wd={},Dd=(Wd[S.za]="br",Wd[S.Ya]="bw",Wd[S.Ca]="bi",Wd[S.Sa]="bo",Wd),Xd={Od:"PC"},Yd={BYTE:1,Nd:2,Sd:4,
vc:5,hc:6,he:7},nd={"=":Yd.he,1:Yd.BYTE,2:Yd.Nd,4:Yd.Sd,"@":Yd.vc,";":Yd.hc},Rd=1E5,Ad={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},zd={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};function Zd(a,b,c){hd.call(this,a,b,c)}m(Zd,hd);
function $d(a,b,c){hd.call(this,a,b,c);this.L=+this.s.model||ae;this.X=+this.s.addrReset||0;this.i=O(this,"Bus");this.i.v=this.Pd.bind(this);this.Be=O(this,"IOPage");O(this,"Panel",!1);this.v=0;this.Ab=null;O(this,"Input",!1);this.L<=be?(this.Nc=this.oe,this.Pc=~(ce|de|ee|fe)&65535,this.Vb=0):(this.Nc=this.pe,this.Pc=~(ce|(this.L<=ge?de:0))&65535,this.Vb=this.L>ge?de:0);this.Eb=this.Db=this.ia=0;this.g=null;this.Ua=[];he(this)}m($d,Zd);
function he(a){a.Z=65536;a.ea=32768;a.fa=65535;a.ca=32768;a.R=15;a.b=[0,0,0,0,0,0,0,a.X,-1,-2,-3,-4,-5,-6,-7,-8];a.U=[0,0,0,0,0,0];a.ra=[0,0,0,0];a.xa=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];a.Na=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];a.La=
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];a.Rc=[0,0,0,0,0,0,0,0];a.c=0;a.j=-1;a.Qc=0;a.a=0;ie(a);for(var b={Ga:0};7>=b.Ga;b={Ga:b.Ga},b.Ga++)M(a,"R"+b.Ga,function(c){return function(){return a.b[c.Ga]}}(b),function(c){return function(d){return a.b[c.Ga]=d&65535}}(b));wb(a,"R6","SP");wb(a,"R7",Xd.Od);M(a,"CF",function(){return a.Z&65536&&je?1:0},function(c){a.Z=c?65536:0});M(a,"NF",function(){return a.ca&32768&&me?1:0},function(c){a.ca=c?32768:0});M(a,"VF",function(){return a.ea&
32768&&ne?1:0},function(c){a.ea=c?32768:0});M(a,"ZF",function(){return(a.fa&65535?0:oe)?1:0},function(c){a.fa=c?0:1});M(a,"PS",function(){return pe(a)},function(c){return qe(a,c)});M(a,"PI",function(){return a.qa},function(c){if(c&=re){var d=c>>se;do c+=te;while(d>>=1);a.a|=ue}a.qa=c});M(a,"ER",function(){return a.ma});M(a,"SL",function(){return a.H&65280},function(c){a.H=c|255});M(a,"M0",function(){return ve(a)},function(c){return we(a,c)});M(a,"M1",function(){return xe(a)});M(a,"M2",function(){return ye(a)});
M(a,"M3",function(){return a.m},function(c){return ze(a,c)})}function ie(a){a.f=0;a.na=0;a.oa=0;a.m=0;a.ma=0;a.qa=0;a.H=255;a.N=0;a.I=0;a.K=0;a.u=262143;a.Oc=[4,2,0,1];a.J=a.b[7];a.h=0;a.g=null;Ae(a);for(var b=a.i,c=Q.Oa,d=0,e=0;e<b.a.length;e++){var f=b.a[e];f.type&c&&(d=f.da+f.size)}a.Ae=d}l=$d.prototype;l.Zc=function(){};function ve(a){var b=a.f;b&Be||(b=b&~(Ce|De|Ee)|a.I<<5|a.K<<1);return b}
function we(a,b){b&=~Ce;if(a.f!=b){b&Be&&!(a.f&Be)&&(a.na=a.h>>16&65535,a.oa=a.h&65535);a.f=b;a.I=(b&Ee)>>Fe;a.K=(b&De)>>Ge;var c=0;b&(He|Ie)&&(c=Je,b&He&&(c|=Ke));a.N!=c&&(a.N=c,Ae(a))}}function xe(a){a.f&Be||(a.na=a.h>>16&65535);a=a.na;a&65280&&(a=(a<<8|a>>8)&65535);return a}function ye(a){a.f&Be||(a.oa=a.h&65535);return a.oa}function ze(a,b){a.L<ae&&(b&=~(Le|Me));a.m!=b&&(a.m=b,a.u=b&Le?Ne:Oe,Ae(a))}
function Ae(a){a.Ab&&Xc(a.i,a.v,a.Ab);a.N?(a.Va=Pe,a.v=a.m&Le?Qe:Re,a.Bb=a.Ve,a.Xc=a.tf):(a.Va=0,a.v=Se,a.Bb=a.Ue,a.Xc=a.sf);a.Ab=Xc(a.i,a.v,a.Be)}
l.sa=function(a){if(!a||!a.length)return G(this,"invalid saved state"),!1;var b=a.shift(),c=a.shift();if(b!=this.M||3!==(c|0))return this.l("CPU state mismatch (%s %3.2f)\n",b,c),!1;try{this.b=a.shift();this.U=a.shift();this.ra=a.shift();this.xa=a.shift();this.Na=a.shift();this.La=a.shift();this.Rc=a.shift();this.ma=a.shift();this.Qc=a.shift();this.qa=a.shift();this.H=a.shift();this.I=a.shift();this.K=a.shift();this.J=a.shift();this.a=a.shift();this.h=a.shift();this.j=a.shift();this.Db=a.shift();
this.Eb=a.shift();this.X=a.shift();qe(this,a.shift());we(this,a.shift());this.na=a.shift();this.oa=a.shift();ze(this,a.shift());for(var d=a.shift(),e=d.length-1;0<=e;e--){a:{for(a=0;a<this.Ua.length;a++){var f=this.Ua[a];if(f.qb===d[e]){var g=f;break a}}g=null}g&&(g.next=this.g,this.g=g)}}catch(k){return G(this,"CPU state error: "+k.message),!1}return!0};
l.ta=function(a){a.push(this.M);a.push(3);a.push(this.b);a.push(this.U);a.push(this.ra);a.push(this.xa);a.push(this.Na);a.push(this.La);a.push(this.Rc);a.push(this.ma);a.push(this.Qc);a.push(this.qa);a.push(this.H);a.push(this.I);a.push(this.K);a.push(this.J);a.push(this.a);a.push(this.h);a.push(this.j);a.push(this.Db);a.push(this.Eb);a.push(this.X);a.push(pe(this));a.push(ve(this));a.push(xe(this));a.push(ye(this));a.push(this.m);a.push(Te(this))};
function Ue(a,b,c){b={qb:b,priority:4,message:c||0,name:Ve[b],next:null};a.Ua.push(b);return b}function We(a,b){if(b){if(b!=a.g){var c=a.g;if(!c||c.priority<=b.priority)b.next=c,a.g=b;else{do{var d=c.next;if(!d||d.priority<=b.priority){b.next=d;c.next=b;break}c=d}while(c)}}a.a|=ue;a.l(v.INT+b.message,"setIRQ(vector=%o,priority=%d)\n",b.qb,b.priority+")")}}function Te(a){var b=[];for(a=a.g;a;)b.push(a.qb),a=a.next;return b}
function pe(a){return a.R=a.R&(fe|ee|de|Xe|Ye)|(a.ca&32768?me:0)|(a.fa&65535?0:oe)|(a.ea&32768?ne:0)|(a.Z&65536?je:0)}function qe(a,b){b&=a.Pc;a.ca=b<<12;a.fa=~b&4;a.ea=b<<14;a.Z=b<<16;if((b^a.R)&a.Vb)for(var c=a.U.length;0<=--c;){var d=a.b[c];a.b[c]=a.U[c];a.U[c]=d}a.c=b>>Ze&$e;c=a.R>>Ze&$e;a.c!=c&&(a.ra[c]=a.b[6],a.b[6]=a.ra[a.c]);a.R=b;a.a&=~af;a.a|=a.g?af:ue}l.Pd=function(a,b){3>=b&&(this.o.ma|=bf);cf(this,df,0,a)};
function cf(a,b,c,d){a.l(v.Fc,"trap to vector %o (%o: %s)\n",b,d,0>d?ef[-d]:"BUS ERROR");if(!a.ia){0>a.j?a.j=pe(a):a.c||(d=ff);d==ff&&(a.a&gf&&(d=hf),a.a|=gf,a.ma|=jf,a.b[6]=b=4);if(d!=hf){a.h=b|4143316992;a.c=0;var e=a.Bb(b|a.Va),f=a.Bb(b+2&65535|a.Va);qe(a,f&~ee|a.j>>2&ee);kf(a,a.j);kf(a,a.b[7]);a.b[lf]=e&65535}a.a&=~(c|mf|nf);a.a=a.a|ue|of;a.j=-1;a.Db=d;a.Eb=b;d==hf&&Cc(a.time);if(d>=ff)throw b;}}function pf(a,b){var c=b>>13&31;31>c&&(b=a.m&Me?a.La[c]+(b&8191)&Ne:b&~qf);return b}
function rf(a,b,c){if(!(c&a.N)){var d=b&65535;d>=Se&&(d|=a.v);return d}var e=b>>13;a.m&a.Oc[a.c]||(e&=7);var f=a.Na[a.c][e];d=(a.xa[a.c][e]<<6)+(b&8191)&a.u;d>=qf&&(d=pf(a,d));if(a.ia)return d;d>=a.Ae&&d<a.v?(a.ma|=sf,cf(a,df,0,d)):d&1&&!(c&tf)&&(a.ma|=uf,cf(a,df,0,d));var g=0;switch(f&vf){case wf:g=xf;case yf:f|=zf;c&Je&&(g=Af);break;case Bf:g=xf;case Cf:c&Je&&(g=xf);case Df:f|=c&Je?zf|Ef:zf;break;default:g=Ff}(f&(Gf|Hf))!=Gf&&(f&Hf?f&Gf&&(b&8128)<(f>>2&8128)&&(g|=If):(b&8128)>(f>>2&8128)&&(g|=If));
a.Na[a.c][e]=f;if(d!=((Qe|Jf)&a.u)||a.c)a.I=a.c,a.K=e;g&&(g&Be&&(0<=a.j&&(g|=Kf),a.f&Be||(g|=a.f&xf|a.I<<5|a.K<<1,we(a,a.f&~Lf|g&Lf)),cf(a,Mf,Nf,Of)),a.f&(Be|xf)||!(d<((Qe|Pf)&a.u)||d>((Qe|Qf|1)&a.u))||(a.f|=xf,a.f&Rf&&(a.a|=Nf)));return d}function kf(a,b){var c=a.b[6]-2&65535;a.b[6]=c;a.h=a.h&65535|(a.h&-65536)<<8|16121856;a.a&gf||a.Nc(Sf,-2,c);a.Xc(c,b)}l.oe=function(a,b,c){!this.c&&0>=b&&c<=this.H&&(this.a|=Tf)};
l.pe=function(a,b,c){this.c||(65534<=c&&(c|=-65536),a&Je&&c<=this.H&&(c<=this.H-32?cf(this,df,0,ff):(this.ma|=Uf,this.a|=Tf)))};l.Ue=function(a){return this.i.ha(this.J=a)};l.Ve=function(a){return this.i.ha(this.J=rf(this,a,Vf))};l.sf=function(a,b){this.i.ba(this.J=a,b)};l.tf=function(a,b){this.i.ba(this.J=rf(this,a,Sf),b)};
l.toString=function(){var a="";if(this.W)for(var b="R0 R1 R2 R3 R4 R5  SP PC PS PI SL NF ZF VF CF  M0 M1 M2 M3 ER  SR AR DR".split(" "),c=0;c<b.length;c++){var d=b[c];if(d){var e=16;"F"==d[1]&&(e=1);var f=zb(this,d);void 0!=f&&(a+=this.W.w("%s=%*n ",d,e,f))}else a+="\n"}return a};
var be=1120,ge=1140,ae=1170,$e=3,je=1,ne=2,oe=4,me=8,Ye=16,Xe=224,ce=1792,de=2048,ee=12288,fe=49152,Ze=14,re=65024,te=34,se=9,df=4,Mf=168,hf=-1,Of=-2,ff=-4,ef="UNKNOWN PANIC ABORT ILLEGAL RED YELLOW FAULT TRACE HALT OPCODE INTERRUPT".split(" "),ue=1,af=2,nf=3,mf=16,Tf=32,Nf=64,of=128,gf=256,lf=7,tf=1,Ke=2,Je=4,Pe=65536,jf=4,Uf=8,bf=16,sf=32,uf=64,He=1,De=30,Ee=96,Kf=128,Ie=256,Rf=512,Ce=3072,xf=4096,Af=8192,If=16384,Ff=32768,Be=57344,Lf=61694,Ge=1,Fe=5,Le=16,Me=32,wf=1,yf=2,Bf=4,Cf=5,Df=6,vf=7,Hf=
8,Ef=64,zf=128,Gf=32512,Pf=62592,Jf=65402,Qf=65470,Ve={48:"DL11R",52:"DL11X",56:"PC11R",60:"PC11X",64:"KW11",112:"RL11",144:"RK11",180:"RX11"},Vf=0|Ke,Sf=0|Je,Se=57344,Re=253952,Qe=4186112,Oe=262143,qf=3932160,Ne=4194303;x.PDP11=$d;function Wf(a,b,c){jd.call(this,a,b,c);this.qa=Xf;this.J=[];this.o.L<ge&&(this.J=this.J.concat(Yf));1145>this.o.L&&(this.J=this.J.concat(Zf));this.ea=6}m(Wf,jd);
Wf.prototype.Rb=function(a,b,c){function d(E){var C=h.o,F=[];if(C.N){var R=C.c<<1,N=E>>13;7<N&&(R|=1);C.m&C.Oc[C.c]||(N&=7);var ke=E&8191,le=C.xa[C.c][N]<<6;E=le+ke&C.u;E>=qf&&(E=pf(C,E));F.push(E);F.push(ke);F.push(R);F.push(N&7);F.push(le);F.push(C.u)}else E&=65535,E>=Se&&(E|=C.v),F.push(E);return null}function e(E){return $f[E]||"?"}function f(E,C){var F="",R=C&ag;if(R==U)F=a.O+((E&255)<<24>>23)&65535,F=k(F);else if(R==bg)F=a.O-((E&63)<<1)&65535,F=k(F);else if(R==cg)F=z(h,E&7,0,3,"");else if(R==
dg)F=z(h,E&63,0,6,"");else if(R==eg)F=z(h,E&255,0,8,"");else if(E&=C,C&V&&(E>>=6,C>>=6),C&W){R=null;var N=E&7;switch(E&56){case 0:F=e(N);break;case 8:F="@"+e(N);R=d(h.o.b[N]);break;case 16:7>N?F="("+e(N)+")+":(C=g(),F="#"+k(C));break;case 24:7>N?F="@("+e(N)+")+":(C=g(),F="@#"+k(C),R=d(C));break;case 32:F="-("+e(N)+")";break;case 40:F="@-("+e(N)+")";break;case 48:C=g();F=k(C)+"("+e(N)+")";7==N&&(F=k(C=C+a.O&65535),R=d(C));break;case 56:C=g(),F="@"+k(C)+"("+e(N)+")",7==N&&(F="@"+k(C=C+a.O&65535),E=
h.o,E.ia++,C=E.i.ha(rf(E,C,Vf)),E.ia--,R=d(C))}R&&(F=[F,R])}return F}function g(){var E=b.shift()|b.shift()<<8;n+=k(E)+" ";qd(h,a,2);return E}function k(E){return z(h,E,0,16,"")}var h=this,p=Nd(this,a),n="",t=pd(this,a,Yd.vc),q=pd(this,a,Yd.hc),r=g(),w;for(A in this.qa)if(w=this.qa[A][r&A])break;w||(w=fg);var u=w[0];0<=this.J.indexOf(u)&&(w=fg,u=w[0]);var A=gg[u];var B="",y=w.length-1;u||y||(B=k(r));for(u=1;u<=y;u++){var X=w[u];if(void 0!=X){X=f(r,X);if(!X||!X.length){B="INVALID";break}"string"!=
typeof X&&(X=X[0]);0<B.length&&(B+=",");B+=X||"???"}}p=this.w("%s %-21s %-7s %s",p,n,A,B);c?q&&(c+=" "+q):q&&(c=q);c&&(p=this.w("%-32s; %s",p,c));t&&(p=t+":\n"+p);return p+"\n"};
var gg=".WORD ADC ADCB ADD ASL ASLB ASR ASRB BCC BCS BEQ BGE BGT BHI BIC BICB BIS BISB BIT BITB BLE BLOS BLT BMI BNE BPL BPT BR BVC BVS CCC CLC CLCN CLCV CLCVN CLCVZ CLCZ CLCZN CLN CLR CLRB CLV CLVN CLVZ CLVZN CLZ CLZN CMP CMPB COM COMB DEC DECB INC INCB HALT JMP JSR MARK MFPD MFPI MFPS MOV MOVB MTPD MTPI MTPS NEG NEGB NOP RESET ROL ROLB ROR RORB RTI RTS SBC SBCB SCC SEC SECN SECV SECVN SECVZ SECZ SECZN SEN SEV SEVN SEVZ SEVZN SEZ SEZN SUB SWAB SXT TST TSTB WAIT MUL DIV ASH ASHC XOR SOB EMT TRAP SPL IOT RTT MFPT".split(" "),$f=
"R0 R1 R2 R3 R4 R5 SP PC A0 A1 A2 A3 A4 A5 A6 A7 S0 S1 S2 S3 PS PI ER SL M0 M1 M2 M3 AR DR SR".split(" "),W=63,V=4032,U=4096,bg=8192,cg=12288,dg=24576,eg=32768,ag=61440,Xf={61440:{4096:[62,V,W],8192:[47,V,W],12288:[18,V,W],16384:[14,V,W],20480:[16,V,W],24576:[3,V,W],36864:[63,V,W],40960:[48,V,W],45056:[19,V,W],49152:[15,V,W],53248:[17,V,W],57344:[94,V,W]},65024:{2048:[57,448,W],28672:[100,W,448],29184:[101,W,448],29696:[102,W,448],30208:[103,W,448],30720:[104,448,W],32256:[105,448,bg]},65280:{256:[27,
U],512:[24,U],768:[10,U],1024:[11,U],1280:[22,U],1536:[12,U],1792:[20,U],32768:[25,U],33024:[23,U],33280:[13,U],33536:[21,U],33792:[28,U],34048:[29,U],34304:[8,U],34560:[9,U],34816:[106,eg],35072:[107,eg]},65472:{64:[56,W],192:[95,W],2560:[39,W],2624:[49,W],2688:[53,W],2752:[51,W],2816:[67,W],2880:[1,W],2944:[77,W],3008:[97,W],3072:[73,W],3136:[71,W],3200:[6,W],3264:[4,W],3328:[58,dg],3392:[60,W],3456:[65,W],3520:[96,W],35328:[40,W],35392:[50,W],35456:[54,W],35520:[52,W],35584:[68,W],35648:[2,W],
35712:[78,W],35776:[98,W],35840:[74,W],35904:[72,W],35968:[7,W],36032:[5,W],36096:[66,W],36160:[59,W],36224:[64,W],36288:[61,W]},65528:{128:[76,7],152:[108,cg]},65535:{0:[55],1:[99],2:[75],3:[26],4:[109],5:[70],6:[110],7:[111],160:[69],161:[31],162:[41],163:[33],164:[45],165:[36],166:[43],167:[35],168:[38],169:[32],170:[42],171:[34],172:[46],173:[37],174:[44],175:[30],176:[69],177:[80],178:[88],179:[82],180:[92],181:[85],182:[90],183:[84],184:[87],185:[81],186:[89],187:[83],188:[93],189:[86],190:[91],
191:[79]}},fg=[0],Yf=[58,60,65,96,110,100,101,102,103,104,105],Zf=[108,59,64];x.PDP11Dbg=Wf;function hg(a,b,c){ad.call(this,a,b,c);for(var d in ig){var e=ig[d];d=+d;a=e[0];b=e[1];c=e[2];e=e[3];65472<=d&&65487>=d&&(!a&&c&&(a=function(f){return function(g){return f(g)&255}}(c)),!b&&e&&(b=function(f){return function(g,k){return f(g,k)}}(e)));bd(this,this,d,d,a,b,c,e)}this.la()}m(hg,ad);l=hg.prototype;l.ka=function(){void 0===this.o&&(this.o=O(this,"Debugger"))};
l.sa=function(a){return a&&(a=a.shift(),this.M==a)?!0:!1};l.ta=function(a){a.push(this.M)};l.Re=function(a){a=a>>1&63;var b=this.o.La[a>>1];return a&1?b>>16:b&65535};l.pf=function(a,b){a=a>>1&63;var c=a>>1;this.o.La[c]=a&1?this.o.La[c]&65535|(b&63)<<16:this.o.La[c]&-65536|b&65534};var jg={},ig=(jg[61568]=[null,null,hg.prototype.Re,hg.prototype.pf,"UNIMAP",64,ae],jg);x.IOPage=hg;v.nd=4294967296;J.dl11=v.nd;
function Y(a,b,c){L.call(this,a,b,c);this.I=+this.s.baudReceive||9600;this.K=+this.s.baudTransmit||9600;this.time=O(this,"Time");this.L=Mb(this.time,this.M+".receive",this.$c.bind(this));this.N=Mb(this.time,this.M+".transmit",this.cf.bind(this));this.ports=O(this,"IOPage");cd(this.ports,this,kg);this.f="";this.c=this.g=this.j=null;this.exports={connect:this.Ce,receiveData:this.$c,receiveStatus:this.Ye,setConnection:this.$e};this.la()}m(Y,L);l=Y.prototype;
l.Ce=function(a){if(!this.c){var b=yb(this,"connection");if(b){var c=b.split("->");if(2==c.length){var d=c[0].trim();if(d!=this.M)return;c=c[1].trim();if(this.c=ub(this,c)){var e=this.c.exports;if(e){var f=e.connect;f&&f.call(this.c,this.u);if(this.g=e.receiveData){this.u=a;this.j=e.receiveStatus;this.l("Connected %s.%s to %s\n",this.T,d,c);return}}}}this.l("Unable to establish connection: %s\n",b)}}};
l.sa=function(a){var b=a.shift();return this.M==b?(this.h=a.shift(),this.a=a.shift(),this.b=a.shift(),this.m=a.shift(),!0):!1};l.ta=function(a){a.push(this.M);a.push(this.h);a.push(this.a);a.push(this.b);a.push(this.m)};l.ka=function(){this.o||(this.o=O(this,"CPU"),this.H=Ue(this.o,this.J?-1:48,v.Wa),this.i=Ue(this.o,this.J?-1:52,v.Wa))};l.la=function(){this.h=0;this.a=8192;this.b=128;this.m=[]};
l.$c=function(a){null!=a&&(this.f="number"!=typeof a?a:this.f+String.fromCharCode(a));this.f&&(a=this.f.charCodeAt(0),this.l(v.Wa,"receiveByte(%#04x)\n",a),this.v?a=!1:(this.h=a,this.a&128?this.h|=49152:this.a|=128,this.a&64&&We(this.o,this.H),a=!0),a&&(this.f=this.f.substr(1)),this.f&&Rb(this.time,this.L,1E3/Math.round(this.I/10)));return!0};l.Ye=function(a){var b=this.a;this.a&=-12289;a&wa.jc.pa&&(this.a|=8192);a&wa.ec.pa&&(this.a|=4096);b!=this.a&&(this.a|=32768,this.a&32&&We(this.o,this.H))};
l.$e=function(a,b){return this.c?!1:(this.c=a,this.g=b,!0)};l.cf=function(a){var b=!0;this.b|=128;this.b&64&&We(this.o,this.i);a&&(b=this.g?this.g.call(this.c,a):!1);return b};l.Qe=function(){var a=this.a&65534;this.a&=-32769;return a};l.nf=function(a){var b=a^this.a;this.a=this.a&-112|a&111;this.j&&b&6&&(b=0,this.u?(b|=a&4?wa.jc.pa:0,b|=a&2?wa.pd.pa|wa.ec.pa:0):(b|=a&4?wa.Ud.pa:0,b|=a&2?wa.qd.pa:0),this.j.call(this.c,b))};l.Pe=function(){this.a&=-129;return this.h};l.mf=function(){};l.Xe=function(){return this.b};
l.vf=function(a){if(this.b&128)if(a&64)We(this.o,this.i);else{var b=this.o,c=this.i;if(c){var d=b.g;if(d==c)b.g=c.next;else for(;d;){var e=d.next;if(e==c){d.next=e.next;break}d=e}b.g&&(b.a|=ue);b.l(v.INT+c.message,"clearIRQ(vector=%o,priority=%d)\n",c.qb,c.priority+")")}}this.b=this.b&-70|a&69};l.We=function(){return 0};
l.uf=function(a){a:{a&=255;this.l(v.Wa,"transmitByte(%#04x)\n",a);if(this.R){if(19==a){this.v=!0;break a}if(17==a){this.v=!1;break a}}this.g&&this.g.call(this.c,a);Rb(this.o,this.N,1E3/Math.round(this.K/10))}this.b&=-129};var lg={},kg=(lg[65392]=[null,null,Y.prototype.Qe,Y.prototype.nf,"RCSR"],lg[65394]=[null,null,Y.prototype.Pe,Y.prototype.mf,"RBUF"],lg[65396]=[null,null,Y.prototype.Xe,Y.prototype.vf,"XCSR"],lg[65398]=[null,null,Y.prototype.We,Y.prototype.uf,"XBUF"],lg);x.DL11=Y;v.ya=8589934592;
J.pc11=v.ya;
function Z(a,b,c){L.call(this,a,b,c);this.name=this.s.name||"PTR";this.b=yb(this,"autoLoad")||"";this.K=+this.s.baudReceive||3600;this.c=this.s.library||[];this.j=null;this.H=window&&"FileReader"in window;this.u=O(this,"Bus");this.time=O(this,"Time");this.L=Mb(this.time,this.M+".reader",this.je.bind(this));O(this,"Input");this.m=null;this.h=this.a=0;this.v=32768;this.f=this.I=0;this.i=[];this.g=mg;this.J=-1;this.ports=O(this,"IOPage");cd(this.ports,this,ng);Ya(this,this.c,this.Ge.bind(this))||Bb(this,
!1)}m(Z,L);l=Z.prototype;
l.Ia=function(a,b){var c=this,d=mg;switch(a){case "readTape":d=og;case "loadTape":d||(d=pg);b.onclick=function(){var e=c.Y[qg];e&&(e=c.c[e.selectedIndex])&&rg(c,e,d)};break;case "mountTape":if(!this.H){this.l("Local tape support not available\n");b.parentNode.removeChild(b);break}b.addEventListener("change",function(){var e=b.children[0];e.children[1].disabled=!e.children[0].files.length});b.onsubmit=function(e){(e=e.currentTarget[1].files[0])&&rg(c,{name:Ea(e.name,!0),path:e.name},pg,e);return!1};
break;default:L.prototype.Ia.call(this,a,b)}};l.Ee=function(){var a=this.Y[sg],b=this.Y[qg],c=b.options[b.selectedIndex];if(a&&c){b={};if(c=c.getAttribute("data-value"))try{b=eval("("+c+")")}catch(d){this.l("PC11 option error: %s",d.message)}c=b.desc;void 0===c&&(c="");b=b.href;void 0!==b&&(c='<a href="'+b+'" target="_blank">'+c+"</a>");a.innerHTML=c}};l.sa=function(a){a=a.shift();return this.M==a?!0:!1};l.ta=function(a){a.push(this.M)};
l.ka=function(){this.o||(this.o=O(this,"CPU"),this.m=Ue(this.o,56,v.ya))};l.la=function(){this.a&=-2241;this.h=0};
function rg(a,b,c,d){var e=b.name,f=b.path;a.l(v.ya,'load("%s","%s")\n',e,f);if(!f)return tg(a),!0;if(f==ug)return Ra(a,'Use "Choose File" and "Mount" to select and load a local tape.'),!0;if(f==vg){f=window.prompt("Enter the URL of a remote tape image.","")||"";if(!f)return!1;e=Ea(f);a.l('Attempting to load %s as "%s"',f,e)}a.g=c;if(d){var g=new FileReader;g.onload=function(){var k=g.result;k&&(b.values=new Uint8Array(k,0,k.byteLength),a.Mb(b));wg(a)};g.readAsArrayBuffer(d);return!1}if(!b.values&&
!Ya(a,b.path,a.Mb.bind(a)))return!1;a.Mb(b);return!0}function wg(a){if(a.j){var b=a.Y[qg];if(b&&b.options){var c;for(c=0;c<b.options.length;c++)if(b.options[c].value==a.j.path){b.selectedIndex!=c&&(b.selectedIndex=c);break}c==b.options.length&&(b.selectedIndex=0)}}}function xg(a,b){b|=0;if(b!==a.J){var c=a.Y[yg];c&&(c=(c=c.getElementsByClassName(zg))&&c[0])&&c.style&&(c.style.width=b+"%");a.J=b}}
l.Ge=function(a){a=this.c=a||[];var b=this.Ee.bind(this),c=qg,d=this.Y[c];if(d){for(var e=0;e<a.length;e++)Sb(this,c,a[e].name,a[e].path);b&&(d.onchange=b)}Sb(this,qg,"None",Ag,!0);this.H&&Sb(this,qg,"Local Tape",ug);Sb(this,qg,"Remote Tape",vg);Bb(this,!0);if(this.b&&"string"==typeof this.b){for(a=0;a<this.c.length;a++)if(b=this.c[a],"object"==typeof b&&b.name==this.b){this.b=b;break}a==this.c.length&&(Ra(this,"Unable to find %s media: %s",this.M),this.b="")}this.b?rg(this,this.b,pg)||Bb(this,!1):
wg(this)};
l.Mb=function(a){var b=a.name,c=a.values,d=a.addrLoad,e=a.addrExec;this.j=a;Bb(this,!0);if(this.g==og){var f=e,g=a=!1;e=!1;if(null==d)for(var k=0;k<c.length-1;){var h=c[k]&255|(c[k+1]&255)<<8;if(h)if(h&255){var p=k;if(1!=h){this.l(v.ya,"invalid signature (%#06x) at offset %#06x\n",h,p);break}if(k+6>=c.length){this.l(v.ya,"invalid block at offset %#06x\n",p);break}k+=2;var n=c[k++]&255|(c[k++]&255)<<8,t=c[k++]&255|(c[k++]&255)<<8;h+=(n&255)+(n>>8)+(t&255)+(t>>8);for(var q=k,r=n-=6;0<n&&k<c.length;)h+=
c[k++]&255,n--;if(0!=n||k>=c.length){this.l(v.ya,"insufficient data for block at offset %#06x\n",p);break}h+=c[k++]&255;if(h&255){this.l(v.ya,"invalid checksum (%#04x) for block at offset %#06x\n",h,p);break}if(r)for(this.l(v.ya,"loading %#06x bytes at %#06x-%#06x\n",r,t,t+r);r--;)this.u.bb(t++,c[q++]&255);else t&1?g=!0:null==f&&(f=t),null!=f&&this.l(v.ya,"starting address: %#06x\n",f);e=!0}else k++;else k+=2}if(!e&&(null==d&&(d=null),null!=d)){for(e=0;e<c.length;e++)this.u.bb(d+e,c[e]);e=!0}if(e){if(null==
f||g)Cc(this.time),a=!1;if(null!=f&&(c=this.o,d=f,c.X=d,c.b[lf]=d&65535,qe(c,0),ie(c),a)){c.b[0]=0;for(a=1;5>=a;a++)c.b[a]=0;c.b[6]=1024}}e?this.l('Read tape "%s"',b):Ra(this,'No valid memory address for tape "%s"',b)}else this.f=0,this.i=c,this.a&=-32769,this.l('Loaded tape "%s" (%d bytes)',b,c.length),xg(this,0)};function tg(a){a.j=null;a.g&&a.l(a.g==pg?"tape detached":"tape unloaded");a.g=mg;wg(a)}
l.je=function(){1!=(this.a&32769)||this.a&128||(this.f<this.i.length?(this.h=this.i[this.f]&255,this.l(v.ya,"%s.advanceReader(%d): %#02x\n",this.M,this.f,this.h),this.f++,xg(this,this.f/this.i.length*100)):this.a|=32768,this.a|=128,this.a&=-2049,this.a&64&&We(this.o,this.m))};l.Oe=function(){return this.a&65534};l.lf=function(a){a&1&&(this.a&32768?(a&=-2,this.a&64&&We(this.o,this.m)):(this.a&=-129,this.a|=2048,this.h=0,Rb(this.time,this.L,1E3/Math.round(this.K/10))));this.a=this.a&-66|a&65};
l.Ne=function(){this.a&=-129;this.a|=2048;return this.h};l.kf=function(){};l.Me=function(){return this.v};l.jf=function(a){this.v=this.v&-65|a&64};l.Le=function(){return this.I};l.hf=function(a){this.I=a&255};
var Ag="",ug="?",vg="??",mg=0,pg=1,og=2,qg="listTapes",sg="descTape",yg="readProgress",zg="progressBar",Bg={},ng=(Bg[65384]=[null,null,Z.prototype.Oe,Z.prototype.lf,"PRS"],Bg[65386]=[null,null,Z.prototype.Ne,Z.prototype.kf,"PRB"],Bg[65388]=[null,null,Z.prototype.Me,Z.prototype.jf,"PPS"],Bg[65390]=[null,null,Z.prototype.Le,Z.prototype.hf,"PPB"],Bg);x.PC11=Z;
function Cg(a,b,c){L.call(this,a,a);var d=this;this.c=!1;this.i=c;this.b="";this.h=this.g=!1;Bb(this,!1);this.ja=v.ld;b=b.trim();"{"==b[0]?Dg(this,b):(this.b=b,Za(this.b,function(e,f,g,k){4==g&&(!k&&f?(Dg(d,f),Eg(d)):d.l("error (%d) loading configuration: %s\n",k,e))}));window.addEventListener("load",function(){d.h=!0;Eg(d)});window.addEventListener(cb("iOS")?"pagehide":cb("Opera")?"unload":"beforeunload",function(){Fg(d)});window.addEventListener("pageshow",function(){d.c||d.ka(!0)})}m(Cg,L);
Cg.prototype.Ia=function(a,b){var c=this;switch(a){case Gg:b.onclick=function(){c.ka()};break;case Hg:b.onclick=function(){c.la()}}L.prototype.Ia.call(this,a,b)};
function Eg(a){var b=!0;if(a.g&&a.h){for(var c in a.a){var d=void 0,e=a.a[c];try{d=e["class"],x[d]?"Machine"==d?(a.l("PCjs %s v%3.2f\n%s\n",e.name,3,"Copyright \u00a9 2012-2022 Jeff Parsons <Jeff@pcjs.org>"),a.b&&a.l("Configuration: %s\n",a.b)):new x[d](a.T,c,e):a.l('unrecognized %s device "%s"\n',d,c)}catch(g){e.optional||(a.l('error initializing %s device "%s": %s\n',d,c,g.message),b=!1),Db(a,c)}}if(a.f){var f=db(a);xb(a,function(g){return g.Lb&&!g.Lb(f)?(g.l('unable to restore state for device "%s"\n',
g.M),!1):!0})}Bb(a,!0);Cb(a,a.ka.bind(a,b))||a.l("machine %s not ready to power, waiting for device(s)\n",a.T)}}
function Dg(a,b){try{a.a=JSON.parse(b);var c=a.a[a.T];if(!c){c=a.a[Ea(a.b,!0)];if(!c)throw Error("configuration missing machine ID");a.a[a.T]=c}vb(a,c,["autoSave","autoStart"]);a.f=!1!==a.s.autoSave;a.j=!1!==a.s.autoStart;if(a.i){var d=eval("("+a.i+")"),e;for(e in d)a.s[e]=d[e]}a.g=!0}catch(f){c=f.message,(d=c.match(/position ([0-9]+)/))&&(c+=" ('"+b.substr(+d[1],40).replace(/\s+/g," ")+"...')"),G(a,"machine '"+a.T+"' initialization error: "+c)}}
Cg.prototype.ka=function(a){a=void 0===a?!this.c:a;if(Ab(this)){var b=this;a&&G(this,"power on");xb(this,function(c){c.ka&&c!=b&&("CPU"!=c.s["class"]||b.j||Ab(b)?c.ka(a):c.time.update(!0));return!0});(this.c=a)||G(this,"power off")}};Cg.prototype.la=function(){if(Ab(this)){var a=this;xb(this,function(b){b.la&&b!=a&&b.la();return!0});G(this,"reset")}};function Fg(a){if(a.f){var b=[];xb(a,function(c){c.ab&&c.ab(b);return!0});kb(a,b)}a.ka(!1)}var Gg="power",Hg="reset";
window.PDP11v3=function(a,b,c){var d=new Cg(a,b,c);window.command=function(e){return eb(d,e)};return d};x.Machine=Cg;})()

//# sourceMappingURL=pdp11v3.js.map
